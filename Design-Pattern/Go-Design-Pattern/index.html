<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="msvalidate.01" content="AFC59628FC88BD6352D3E7A5AE5FE303"><meta name="google-site-verification" content="uAa2fbb800RIF4HzoIvwlhtlNh7J2m24V8LizLrlCu4"><title>Goçš„è®¾è®¡æ¨¡å¼ - åƒåç”°</title><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#3273dc"><meta name="application-name" content="åƒåç”°"><meta name="msapplication-TileImage" content="/img/favicon.ico"><meta name="msapplication-TileColor" content="#3273dc"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="åƒåç”°"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="Goçš„è®¾è®¡æ¨¡å¼ï¼šâŒæŒ‡åœ¨Goä¸­ä¸å¸¸ç”¨  åˆ›å»ºå‹ å•ä¾‹æ¨¡å¼ï¼šä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ é¥¿æ±‰ï¼šç³»ç»Ÿåˆå§‹åŒ–æ—¶åˆ›å»ºå¹¶åˆå§‹åŒ–å•ä¾‹å¯¹è±¡ æ‡’æ±‰ï¼šè°ƒç”¨å®ä¾‹æ—¶åˆå§‹åŒ–å•ä¾‹å¯¹è±¡   å·¥å‚æ¨¡å¼ï¼šä½¿ç”¨å…±åŒæ¥å£åˆ›å»ºå¯¹è±¡ å»ºé€ è€…æ¨¡å¼ï¼šä¸å·¥å‚ä¸åŒåœ¨äºï¼Œåˆ›å»ºå‚æ•°å¤æ‚çš„å¯¹è±¡ åŸå‹æ¨¡å¼ï¼šåˆ©ç”¨å·²æœ‰å¯¹è±¡å¤åˆ¶çš„æ–¹å¼æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ âŒ   ç»“æ„å‹ ä»£ç†æ¨¡å¼ï¼šä¸ºå…¶ä»–å¯¹è±¡æä¾›â¼€ç§ä»£ç†ä»¥æ§åˆ¶è¿™ä¸ªå¯¹è±¡çš„è®¿é—® ä»£ç†è®¿é—® æ¡¥æ¥æ¨¡å¼ï¼šå°†ç±»çš„æŠ½è±¡éƒ¨åˆ†å’Œå®ƒçš„å®ç°éƒ¨åˆ†åˆ†"><meta property="og:type" content="blog"><meta property="og:title" content="Goçš„è®¾è®¡æ¨¡å¼"><meta property="og:url" content="http://blog.sukiu.top/Design-Pattern/Go-Design-Pattern/"><meta property="og:site_name" content="åƒåç”°"><meta property="og:description" content="Goçš„è®¾è®¡æ¨¡å¼ï¼šâŒæŒ‡åœ¨Goä¸­ä¸å¸¸ç”¨  åˆ›å»ºå‹ å•ä¾‹æ¨¡å¼ï¼šä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ é¥¿æ±‰ï¼šç³»ç»Ÿåˆå§‹åŒ–æ—¶åˆ›å»ºå¹¶åˆå§‹åŒ–å•ä¾‹å¯¹è±¡ æ‡’æ±‰ï¼šè°ƒç”¨å®ä¾‹æ—¶åˆå§‹åŒ–å•ä¾‹å¯¹è±¡   å·¥å‚æ¨¡å¼ï¼šä½¿ç”¨å…±åŒæ¥å£åˆ›å»ºå¯¹è±¡ å»ºé€ è€…æ¨¡å¼ï¼šä¸å·¥å‚ä¸åŒåœ¨äºï¼Œåˆ›å»ºå‚æ•°å¤æ‚çš„å¯¹è±¡ åŸå‹æ¨¡å¼ï¼šåˆ©ç”¨å·²æœ‰å¯¹è±¡å¤åˆ¶çš„æ–¹å¼æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ âŒ   ç»“æ„å‹ ä»£ç†æ¨¡å¼ï¼šä¸ºå…¶ä»–å¯¹è±¡æä¾›â¼€ç§ä»£ç†ä»¥æ§åˆ¶è¿™ä¸ªå¯¹è±¡çš„è®¿é—® ä»£ç†è®¿é—® æ¡¥æ¥æ¨¡å¼ï¼šå°†ç±»çš„æŠ½è±¡éƒ¨åˆ†å’Œå®ƒçš„å®ç°éƒ¨åˆ†åˆ†"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231122957.jpeg"><meta property="article:published_time" content="2022-02-23T03:19:37.000Z"><meta property="article:modified_time" content="2022-02-23T06:40:29.992Z"><meta property="article:author" content="SukiEva"><meta property="article:tag" content="Go"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231122957.jpeg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.sukiu.top/Design-Pattern/Go-Design-Pattern/"},"headline":"Goçš„è®¾è®¡æ¨¡å¼","image":[],"datePublished":"2022-02-23T03:19:37.000Z","dateModified":"2022-02-23T06:40:29.992Z","author":{"@type":"Person","name":"SukiEva"},"publisher":{"@type":"Organization","name":"åƒåç”°","logo":{"@type":"ImageObject","url":"https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/blog/favicon.ico"}},"description":"Goçš„è®¾è®¡æ¨¡å¼ï¼šâŒæŒ‡åœ¨Goä¸­ä¸å¸¸ç”¨  åˆ›å»ºå‹ å•ä¾‹æ¨¡å¼ï¼šä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹ é¥¿æ±‰ï¼šç³»ç»Ÿåˆå§‹åŒ–æ—¶åˆ›å»ºå¹¶åˆå§‹åŒ–å•ä¾‹å¯¹è±¡ æ‡’æ±‰ï¼šè°ƒç”¨å®ä¾‹æ—¶åˆå§‹åŒ–å•ä¾‹å¯¹è±¡   å·¥å‚æ¨¡å¼ï¼šä½¿ç”¨å…±åŒæ¥å£åˆ›å»ºå¯¹è±¡ å»ºé€ è€…æ¨¡å¼ï¼šä¸å·¥å‚ä¸åŒåœ¨äºï¼Œåˆ›å»ºå‚æ•°å¤æ‚çš„å¯¹è±¡ åŸå‹æ¨¡å¼ï¼šåˆ©ç”¨å·²æœ‰å¯¹è±¡å¤åˆ¶çš„æ–¹å¼æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ âŒ   ç»“æ„å‹ ä»£ç†æ¨¡å¼ï¼šä¸ºå…¶ä»–å¯¹è±¡æä¾›â¼€ç§ä»£ç†ä»¥æ§åˆ¶è¿™ä¸ªå¯¹è±¡çš„è®¿é—® ä»£ç†è®¿é—® æ¡¥æ¥æ¨¡å¼ï¼šå°†ç±»çš„æŠ½è±¡éƒ¨åˆ†å’Œå®ƒçš„å®ç°éƒ¨åˆ†åˆ†"}</script><link rel="canonical" href="http://blog.sukiu.top/Design-Pattern/Go-Design-Pattern/"><link rel="alternate" href="/rss.xml" title="åƒåç”°" type="application/atom+xml"><link rel="icon" href="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/blog/favicon.ico"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://unpkg.com/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><script>var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "//hm.baidu.com/hm.js?46b8feda6aa9434cccdff91f797b76ad";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();</script><meta name="msvalidate.01" content="AFC59628FC88BD6352D3E7A5AE5FE303"><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><link rel="stylesheet" href="https://unpkg.com/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://unpkg.com/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://unpkg.com/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><script src="https://www.googletagmanager.com/gtag/js?id=G-YW921Z6076" async></script><script>window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
    
        gtag('config', 'G-YW921Z6076');</script><!--!--><!--!--><link rel="stylesheet" href="https://unpkg.com/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css"><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://unpkg.com/pace-js@1.2.4/pace.min.js"></script><meta name="generator" content="Hexo 5.4.0"></head><body class="is-3-column"><script type="text/javascript" src="/js/night.js"></script><canvas id="universe"></canvas><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><span class="logolink"><a class="navbar-item navbar-logo" href="/"><span class="sakuraso">åƒåç”°</span><span class="no">ã®</span><span class="shironeko">Î¼&#039;s</span></a></span></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">ğŸŒˆé¦–é¡µ</a><a class="navbar-item" href="/archives">ğŸ—‚ï¸å½’æ¡£</a><a class="navbar-item" href="/categories">ğŸªåˆ†ç±»</a><a class="navbar-item" href="/tags">ğŸ·ï¸æ ‡ç­¾</a><a class="navbar-item" href="/friends">ğŸ‰å‹é“¾</a><a class="navbar-item" href="/donate">ğŸ’•èµèµ</a><a class="navbar-item" href="/about">ğŸå…³äº</a></div><div class="navbar-end"><a class="navbar-item night" id="night-nav" title="Night Mode" href="javascript:;"><i class="fas fa-moon" id="night-icon"></i></a><a class="navbar-item" target="_blank" rel="noopener" title="Travelling" href="https://travellings.link"><i class="fas fa-subway"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="ç›®å½•" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="æœç´¢" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231122957.jpeg" alt="Goçš„è®¾è®¡æ¨¡å¼"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-02-23T03:19:37.000Z" title="2022/2/23 11:19:37">2022-02-23</time>å‘è¡¨</span><span class="level-item"><time dateTime="2022-02-23T06:40:29.992Z" title="2022/2/23 14:40:29">2022-02-23</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/Design-Pattern/">Design Pattern</a></span><span class="level-item">1 å°æ—¶è¯»å®Œ (å¤§çº¦7511ä¸ªå­—)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span>æ¬¡è®¿é—®</span></div></div><h1 class="title is-3 is-size-4-mobile">Goçš„è®¾è®¡æ¨¡å¼</h1><div class="content"><p>Goçš„è®¾è®¡æ¨¡å¼ï¼šâŒæŒ‡åœ¨Goä¸­ä¸å¸¸ç”¨</p>
<ul>
<li>åˆ›å»ºå‹<ul>
<li>å•ä¾‹æ¨¡å¼ï¼šä¸€ä¸ªç±»åªæœ‰ä¸€ä¸ªå®ä¾‹<ul>
<li>é¥¿æ±‰ï¼šç³»ç»Ÿåˆå§‹åŒ–æ—¶åˆ›å»ºå¹¶åˆå§‹åŒ–å•ä¾‹å¯¹è±¡</li>
<li>æ‡’æ±‰ï¼šè°ƒç”¨å®ä¾‹æ—¶åˆå§‹åŒ–å•ä¾‹å¯¹è±¡</li>
</ul>
</li>
<li>å·¥å‚æ¨¡å¼ï¼šä½¿ç”¨å…±åŒæ¥å£åˆ›å»ºå¯¹è±¡</li>
<li>å»ºé€ è€…æ¨¡å¼ï¼šä¸å·¥å‚ä¸åŒåœ¨äºï¼Œåˆ›å»ºå‚æ•°å¤æ‚çš„å¯¹è±¡</li>
<li>åŸå‹æ¨¡å¼ï¼šåˆ©ç”¨å·²æœ‰å¯¹è±¡å¤åˆ¶çš„æ–¹å¼æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ âŒ</li>
</ul>
</li>
<li>ç»“æ„å‹<ul>
<li>ä»£ç†æ¨¡å¼ï¼šä¸ºå…¶ä»–å¯¹è±¡æä¾›â¼€ç§ä»£ç†ä»¥æ§åˆ¶è¿™ä¸ªå¯¹è±¡çš„è®¿é—® <strong>ä»£ç†è®¿é—®</strong></li>
<li>æ¡¥æ¥æ¨¡å¼ï¼šå°†ç±»çš„æŠ½è±¡éƒ¨åˆ†å’Œå®ƒçš„å®ç°éƒ¨åˆ†åˆ†ç¦»å¼€æ¥ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ– <strong>æŠ½è±¡å®ç°æ‹†åˆ†ç‹¬ç«‹</strong></li>
<li>è£…é¥°æ¨¡å¼ï¼šåŠ¨æ€åœ°ç»™â¼€ä¸ªå¯¹è±¡æ·»åŠ â¼€äº›é¢å¤–çš„èŒè´£ <strong>é™„åŠ èŒè´£</strong></li>
<li>é€‚é…å™¨æ¨¡å¼ï¼šå°†â¼€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆç”¨æˆ·å¸Œæœ›å¾—åˆ°çš„å¦â¼€ä¸ªæ¥å£ <strong>è½¬æ¢æ¥å£</strong></li>
<li>é—¨é¢æ¨¡å¼ï¼šå®šä¹‰â¼€ä¸ªé«˜å±‚æ¥å£ï¼Œä¸ºå­ç³»ç»Ÿä¸­çš„â¼€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„å¤–è§‚ <strong>å¯¹å¤–ç»Ÿä¸€æ¥å£</strong> âŒ</li>
<li>ç»„åˆæ¨¡å¼ï¼šå°†å¯¹è±¡ç»„åˆæˆæ ‘å‹ç»“æ„ä»¥è¡¨ç¤ºâ€æ•´ä½“-éƒ¨åˆ†â€çš„å±‚æ¬¡ç»“æ„ <strong>æ ‘å‹ç›®å½•ç»“æ„</strong> âŒ</li>
<li>äº«å…ƒæ¨¡å¼ï¼šæä¾›æ”¯æŒå¤§é‡ç»†ç²’åº¦å¯¹è±¡å…±äº«çš„æœ‰æ•ˆæ–¹æ³• âŒ</li>
</ul>
</li>
<li>è¡Œä¸ºå‹<ul>
<li>è§‚å¯Ÿè€…æ¨¡å¼ï¼šå®šä¹‰å¯¹è±¡é—´çš„â¼€ç§â¼€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“â¼€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°</li>
<li>æ¨¡æ¿æ¨¡å¼ï¼šå®šä¹‰â¼€ä¸ªæ“ä½œä¸­çš„ç®—æ³•éª¨æ¶ï¼Œè€Œå°†â¼€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜â¼€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡æ–°å®šä¹‰ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤</li>
<li>ç­–ç•¥æ¨¡å¼ï¼šå®šä¹‰â¼€ç³»åˆ—ç®—æ³•ï¼ŒæŠŠå®ƒä»¬â¼€ä¸ªä¸ªå°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬ä¹‹é—´å¯äº’ç›¸æ›¿æ¢ï¼Œä»è€Œè®©ç®—æ³•å¯ä»¥ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„ç”¨æˆ·è€Œå˜åŒ–</li>
<li>èŒè´£é“¾æ¨¡å¼ï¼šé€šè¿‡ç»™å¤šä¸ªå¯¹è±¡å¤„ç†è¯·æ±‚çš„æœºä¼šï¼Œå‡å°‘è¯·æ±‚çš„å‘é€è€…ä¸æ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆã€‚å°†æ¥æ”¶å¯¹è±¡é“¾æ¥èµ·æ¥ï¼Œåœ¨é“¾ä¸­ä¼ é€’è¯·æ±‚ï¼Œç›´åˆ°æœ‰â¼€ä¸ªå¯¹è±¡å¤„ç†è¿™ä¸ªè¯·æ±‚ <strong>ä¼ é€’èŒè´£</strong></li>
<li>çŠ¶æ€æ¨¡å¼ï¼šå…è®¸â¼€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸º</li>
<li>è¿­ä»£å™¨æ¨¡å¼ï¼šæä¾›â¼€ç§æ–¹æ³•æ¥é¡ºåºè®¿é—®â¼€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ è€Œä¸éœ€è¦æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤º</li>
<li>è®¿é—®è€…æ¨¡å¼ï¼šè¡¨ç¤ºâ¼€ä¸ªä½œç”¨äºæŸå¯¹è±¡ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œï¼Œä½¿å¾—åœ¨ä¸æ”¹å˜å„å…ƒç´ çš„ç±»çš„å‰æä¸‹å®šä¹‰ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°æ“ä½œ âŒ</li>
<li>å¤‡å¿˜å½•æ¨¡å¼ï¼šåœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·â¼€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ï¼Œä»è€Œå¯ç”¨åœ¨ä»¥åå°†è¯¥å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€ âŒ</li>
<li>å‘½ä»¤æ¨¡å¼ï¼šå°†â¼€ä¸ªè¯·æ±‚å°è£…ä¸ºâ¼€ä¸ªå¯¹è±¡ï¼Œä»è€Œå¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼Œå°†è¯·æ±‚æ’é˜Ÿæˆ–è®°å½•è¯·æ±‚â½‡å¿—ï¼Œæ”¯æŒå¯æ’¤é”€çš„æ“ä½œ âŒ</li>
<li>è§£é‡Šå™¨æ¨¡å¼ï¼šç»™å®šâ¼€ç§è¯­è¨€ï¼Œå®šä¹‰å®ƒçš„æ–‡æ³•è¡¨ç¤ºï¼Œå¹¶å®šä¹‰â¼€ä¸ªè§£é‡Šå™¨ï¼Œè¯¥è§£é‡Šå™¨ç”¨æ¥æ ¹æ®æ–‡æ³•è¡¨ç¤ºæ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­ âŒ</li>
<li>ä¸­ä»‹æ¨¡å¼ï¼šç”¨â¼€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…â¼€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ã€‚å®ƒä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾å¼åœ°ç›¸äº’è°ƒç”¨ï¼Œä»è€Œè¾¾åˆ°ä½è€¦åˆï¼Œè¿˜å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å¯¹è±¡é—´çš„äº¤äº’ âŒ</li>
</ul>
</li>
</ul>
<span id="more"></span>

<blockquote>
<p>å‚è€ƒï¼š<br><a target="_blank" rel="noopener" href="https://lailin.xyz/post/go-design-pattern.html">Goè®¾è®¡æ¨¡å¼24-æ€»ç»“(æ›´æ–°å®Œæ¯•) - Mohuishou</a></p>
</blockquote>
<h1 id="1ã€åˆ›å»ºå‹"><a href="#1ã€åˆ›å»ºå‹" class="headerlink" title="1ã€åˆ›å»ºå‹"></a>1ã€åˆ›å»ºå‹</h1><p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231202054.png" alt="åˆ›å»ºå‹æ¨¡å¼"></p>
<h2 id="å•ä¾‹æ¨¡å¼-singleton"><a href="#å•ä¾‹æ¨¡å¼-singleton" class="headerlink" title="å•ä¾‹æ¨¡å¼ singleton"></a>å•ä¾‹æ¨¡å¼ singleton</h2><p><strong>ä¸€ä¸ªç±»åªå…è®¸åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼ˆå®ä¾‹ï¼‰</strong>ï¼Œè¿™ä¸ªç±»å°±æ˜¯å•ä¾‹ç±»ï¼Œè¿™ç§è®¾è®¡æ¨¡å¼å°±å«å•ä¾‹æ¨¡å¼</p>
<p><strong>ç”¨å¤„ï¼š</strong> ä¸šåŠ¡ä¸Šï¼Œæœ‰äº›æ•°æ®åœ¨ç³»ç»Ÿä¸­åªåº”è¯¥ä¿å­˜ä¸€ä»½</p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231129062.png" alt="å•ä¾‹æ¨¡å¼"></p>
<h3 id="é¥¿æ±‰å¼"><a href="#é¥¿æ±‰å¼" class="headerlink" title="é¥¿æ±‰å¼"></a>é¥¿æ±‰å¼</h3><blockquote>
<p>åœ¨ç³»ç»Ÿåˆå§‹åŒ–çš„æ—¶å€™æˆ‘ä»¬å·²ç»æŠŠå¯¹è±¡åˆ›å»ºå¥½äº†ï¼Œéœ€è¦ç”¨çš„æ—¶å€™ç›´æ¥æ‹¿è¿‡æ¥ç”¨å°±å¥½äº†</p>
</blockquote>
<p>ç±»ä¸€æ—¦åŠ è½½ï¼Œå°±æŠŠå•ä¾‹åˆå§‹åŒ–å®Œæˆï¼Œä¿è¯<code>getInstance</code>çš„æ—¶å€™ï¼Œå•ä¾‹æ˜¯å·²ç»å­˜åœ¨çš„äº†ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> singleton</span><br><span class="line"></span><br><span class="line"><span class="comment">// Singleton é¥¿æ±‰å¼å•ä¾‹</span></span><br><span class="line"><span class="keyword">type</span> Singleton <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> singleton *Singleton</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">init</span><span class="params">()</span></span> &#123;</span><br><span class="line">    singleton = &amp;Singleton&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GetInstance è·å–å®ä¾‹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetInstance</span><span class="params">()</span> *<span class="title">Singleton</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> singleton</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ‡’æ±‰å¼ï¼ˆåŒé‡æ£€æµ‹ï¼‰"><a href="#æ‡’æ±‰å¼ï¼ˆåŒé‡æ£€æµ‹ï¼‰" class="headerlink" title="æ‡’æ±‰å¼ï¼ˆåŒé‡æ£€æµ‹ï¼‰"></a>æ‡’æ±‰å¼ï¼ˆåŒé‡æ£€æµ‹ï¼‰</h3><blockquote>
<p>åˆ›å»ºå¯¹è±¡æ—¶æ¯”è¾ƒæ‡’ï¼Œå…ˆä¸æ€¥ç€åˆ›å»ºå¯¹è±¡ï¼Œåœ¨éœ€è¦åŠ è½½é…ç½®æ–‡ä»¶çš„æ—¶å€™å†å»åˆ›å»º</p>
</blockquote>
<p>åªæœ‰å½“è°ƒç”¨<code>getInstance</code>çš„æ—¶å€™ï¼Œæ‰ä¼šå»åˆå§‹åŒ–è¿™ä¸ªå•ä¾‹ã€‚</p>
<p>ä¸ºäº†å®ç°æ‡’æ±‰å¼ä¸å¯é¿å…çš„éœ€è¦åŠ é”ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> singleton</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;sync&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> (</span><br><span class="line">    lazySingleton *Singleton</span><br><span class="line">    once          = &amp;sync.Once&#123;&#125;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// GetLazyInstance æ‡’æ±‰å¼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetLazyInstance</span><span class="params">()</span> *<span class="title">Singleton</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> lazySingleton == <span class="literal">nil</span> &#123;</span><br><span class="line">        once.Do(<span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123;</span><br><span class="line">            lazySingleton = &amp;Singleton&#123;&#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> lazySingleton</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å·¥å‚æ¨¡å¼-factory"><a href="#å·¥å‚æ¨¡å¼-factory" class="headerlink" title="å·¥å‚æ¨¡å¼ factory"></a>å·¥å‚æ¨¡å¼ factory</h2><p>åœ¨å·¥å‚æ¨¡å¼ä¸­ï¼Œåœ¨åˆ›å»ºå¯¹è±¡æ—¶ä¸ä¼šå¯¹å®¢æˆ·ç«¯æš´éœ²åˆ›å»ºé€»è¾‘ï¼Œå¹¶ä¸”æ˜¯é€šè¿‡<strong>ä½¿ç”¨ä¸€ä¸ªå…±åŒçš„æ¥å£æ¥æŒ‡å‘æ–°åˆ›å»ºçš„å¯¹è±¡</strong>ã€‚</p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231147355.png" alt="å·¥å‚æ¨¡å¼"></p>
<h3 id="ç®€å•å·¥å‚"><a href="#ç®€å•å·¥å‚" class="headerlink" title="ç®€å•å·¥å‚"></a>ç®€å•å·¥å‚</h3><p>Go æœ¬èº«æ˜¯æ²¡æœ‰æ„é€ å‡½æ•°çš„ï¼Œä¸€èˆ¬è€Œè¨€é‡‡ç”¨ <code>NewName</code> çš„æ–¹å¼åˆ›å»ºå¯¹è±¡/æ¥å£ï¼Œå½“å®ƒè¿”å›çš„æ˜¯æ¥å£çš„æ—¶å€™ï¼Œå…¶å®å°±æ˜¯ç®€å•å·¥å‚æ¨¡å¼ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> factory</span><br><span class="line"></span><br><span class="line"><span class="comment">// IRuleConfigParser IRuleConfigParser</span></span><br><span class="line"><span class="keyword">type</span> IRuleConfigParser <span class="keyword">interface</span> &#123;</span><br><span class="line">    Parse(data []<span class="keyword">byte</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// jsonRuleConfigParser jsonRuleConfigParser</span></span><br><span class="line"><span class="keyword">type</span> jsonRuleConfigParser <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Parse Parse</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(J jsonRuleConfigParser)</span> <span class="title">Parse</span><span class="params">(data []<span class="keyword">byte</span>)</span></span> &#123;</span><br><span class="line">    <span class="built_in">panic</span>(<span class="string">&quot;implement me&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// yamlRuleConfigParser yamlRuleConfigParser</span></span><br><span class="line"><span class="keyword">type</span> yamlRuleConfigParser <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Parse Parse</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(Y yamlRuleConfigParser)</span> <span class="title">Parse</span><span class="params">(data []<span class="keyword">byte</span>)</span></span> &#123;</span><br><span class="line">    <span class="built_in">panic</span>(<span class="string">&quot;implement me&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewIRuleConfigParser NewIRuleConfigParser</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewIRuleConfigParser</span><span class="params">(t <span class="keyword">string</span>)</span> <span class="title">IRuleConfigParser</span></span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> t &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;json&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonRuleConfigParser&#123;&#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;yaml&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> yamlRuleConfigParser&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å·¥å‚æ–¹æ³•"><a href="#å·¥å‚æ–¹æ³•" class="headerlink" title="å·¥å‚æ–¹æ³•"></a>å·¥å‚æ–¹æ³•</h3><p>å½“å¯¹è±¡çš„åˆ›å»ºé€»è¾‘æ¯”è¾ƒå¤æ‚ï¼Œä¸åªæ˜¯ç®€å•çš„ new ä¸€ä¸‹å°±å¯ä»¥ï¼Œè€Œæ˜¯è¦ç»„åˆå…¶ä»–ç±»å¯¹è±¡ã€‚</p>
<p>åšå„ç§åˆå§‹åŒ–æ“ä½œçš„æ—¶å€™ï¼Œæ¨èä½¿ç”¨å·¥å‚æ–¹æ³•æ¨¡å¼ï¼Œå°†å¤æ‚çš„åˆ›å»ºé€»è¾‘æ‹†åˆ†åˆ°å¤šä¸ªå·¥å‚ç±»ä¸­ï¼Œè®©æ¯ä¸ªå·¥å‚ç±»éƒ½ä¸è‡³äºè¿‡äºå¤æ‚ã€‚</p>
<blockquote>
<p>ç»„åˆå¤ç”¨åŸåˆ™ï¼šä¼˜å…ˆä½¿ç”¨ç»„åˆ contains aï¼ˆèšåˆ has aï¼‰ï¼Œè€Œä¸æ˜¯ç»§æ‰¿ is a æ¥è¾¾åˆ°ç›®çš„</p>
<p>è¿ªç±³ç‰¹æ³•åˆ™ï¼šâ¼€ä¸ªå¯¹è±¡åº”å½“å¯¹å…¶ä»–å¯¹è±¡æœ‰å°½å¯èƒ½å°‘çš„äº†è§£ï¼Œå³ä¸å’Œé™Œç”Ÿäººè¯´è¯</p>
<ul>
<li>ä¼˜ç‚¹ï¼šé™ä½ç±»ä¹‹é—´çš„è€¦åˆ</li>
<li>ç¼ºç‚¹ï¼šäº§ç”Ÿå¤§é‡ä¸­ä»‹ç±»ï¼Œè®¾è®¡å˜å¤æ‚</li>
</ul>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// IRuleConfigParserFactory å·¥å‚æ–¹æ³•æ¥å£</span></span><br><span class="line"><span class="keyword">type</span> IRuleConfigParserFactory <span class="keyword">interface</span> &#123;</span><br><span class="line">    CreateParser() IRuleConfigParser</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// yamlRuleConfigParserFactory yamlRuleConfigParser çš„å·¥å‚ç±»</span></span><br><span class="line"><span class="keyword">type</span> yamlRuleConfigParserFactory <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CreateParser CreateParser</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(y yamlRuleConfigParserFactory)</span> <span class="title">CreateParser</span><span class="params">()</span> <span class="title">IRuleConfigParser</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> yamlRuleConfigParser&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// jsonRuleConfigParserFactory jsonRuleConfigParser çš„å·¥å‚ç±»</span></span><br><span class="line"><span class="keyword">type</span> jsonRuleConfigParserFactory <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CreateParser CreateParser</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(j jsonRuleConfigParserFactory)</span> <span class="title">CreateParser</span><span class="params">()</span> <span class="title">IRuleConfigParser</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> jsonRuleConfigParser&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewIRuleConfigParserFactory ç”¨ä¸€ä¸ªç®€å•å·¥å‚å°è£…å·¥å‚æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewIRuleConfigParserFactory</span><span class="params">(t <span class="keyword">string</span>)</span> <span class="title">IRuleConfigParserFactory</span></span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> t &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;json&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> jsonRuleConfigParserFactory&#123;&#125;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;yaml&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> yamlRuleConfigParserFactory&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å»ºé€ è€…æ¨¡å¼-builder"><a href="#å»ºé€ è€…æ¨¡å¼-builder" class="headerlink" title="å»ºé€ è€…æ¨¡å¼ builder"></a>å»ºé€ è€…æ¨¡å¼ builder</h2><p>åœ¨ Golang ä¸­å¯¹äºåˆ›å»ºç±»å‚æ•°æ¯”è¾ƒå¤šçš„å¯¹è±¡çš„æ—¶å€™ï¼Œå¸¸è§çš„åšæ³•æ˜¯å¿…å¡«å‚æ•°ç›´æ¥ä¼ é€’ï¼Œå¯é€‰å‚æ•°é€šè¿‡ä¼ é€’å¯å˜çš„æ–¹æ³•è¿›è¡Œåˆ›å»ºã€‚</p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231158567.png" alt="å»ºé€ è€…æ¨¡å¼"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> builder</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ResourcePoolConfigOption option</span></span><br><span class="line"><span class="keyword">type</span> ResourcePoolConfigOption <span class="keyword">struct</span> &#123;</span><br><span class="line">    maxTotal <span class="keyword">int</span></span><br><span class="line">    maxIdle  <span class="keyword">int</span></span><br><span class="line">    minIdle  <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ResourcePoolConfigOptFunc to set option</span></span><br><span class="line"><span class="keyword">type</span> ResourcePoolConfigOptFunc <span class="function"><span class="keyword">func</span><span class="params">(option *ResourcePoolConfigOption)</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">// NewResourcePoolConfig NewResourcePoolConfig</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewResourcePoolConfig</span><span class="params">(name <span class="keyword">string</span>, opts ...ResourcePoolConfigOptFunc)</span> <span class="params">(*ResourcePoolConfig, error)</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> name == <span class="string">&quot;&quot;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;name can not be empty&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    option := &amp;ResourcePoolConfigOption&#123;</span><br><span class="line">        maxTotal: <span class="number">10</span>,</span><br><span class="line">        maxIdle:  <span class="number">9</span>,</span><br><span class="line">        minIdle:  <span class="number">1</span>,</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _, opt := <span class="keyword">range</span> opts &#123;</span><br><span class="line">        opt(option)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> option.maxTotal &lt; <span class="number">0</span> || option.maxIdle &lt; <span class="number">0</span> || option.minIdle &lt; <span class="number">0</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;args err, option: %v&quot;</span>, option)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> option.maxTotal &lt; option.maxIdle || option.minIdle &gt; option.maxIdle &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;args err, option: %v&quot;</span>, option)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &amp;ResourcePoolConfig&#123;</span><br><span class="line">        name:     name,</span><br><span class="line">        maxTotal: option.maxTotal,</span><br><span class="line">        maxIdle:  option.maxIdle,</span><br><span class="line">        minIdle:  option.minIdle,</span><br><span class="line">    &#125;, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="åŸå‹æ¨¡å¼-prototype"><a href="#åŸå‹æ¨¡å¼-prototype" class="headerlink" title="åŸå‹æ¨¡å¼ prototype"></a>åŸå‹æ¨¡å¼ prototype</h2><p>åˆ©ç”¨å·²æœ‰å¯¹è±¡ï¼ˆåŸå‹ï¼‰è¿›è¡Œå¤åˆ¶ï¼ˆæ‹·è´ï¼‰çš„æ–¹å¼æ¥åˆ›å»ºæ–°çš„å¯¹è±¡ï¼Œè¾¾åˆ°èŠ‚çœåˆ›å»ºæ—¶é—´çš„ç›®çš„ã€‚</p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231203233.png" alt="åŸå‹æ¨¡å¼"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> prototype</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;encoding/json&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Keyword æœç´¢å…³é”®å­—</span></span><br><span class="line"><span class="keyword">type</span> Keyword <span class="keyword">struct</span> &#123;</span><br><span class="line">    word      <span class="keyword">string</span></span><br><span class="line">    visit     <span class="keyword">int</span></span><br><span class="line">    UpdatedAt *time.Time</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Clone è¿™é‡Œä½¿ç”¨åºåˆ—åŒ–ä¸ååºåˆ—åŒ–çš„æ–¹å¼æ·±æ‹·è´</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(k *Keyword)</span> <span class="title">Clone</span><span class="params">()</span> *<span class="title">Keyword</span></span> &#123;</span><br><span class="line">    <span class="keyword">var</span> newKeyword Keyword</span><br><span class="line">    b, _ := json.Marshal(k)</span><br><span class="line">    json.Unmarshal(b, &amp;newKeyword)</span><br><span class="line">    <span class="keyword">return</span> &amp;newKeyword</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Keywords å…³é”®å­— map</span></span><br><span class="line"><span class="keyword">type</span> Keywords <span class="keyword">map</span>[<span class="keyword">string</span>]*Keyword</span><br><span class="line"></span><br><span class="line"><span class="comment">// Clone å¤åˆ¶ä¸€ä¸ªæ–°çš„ keywords</span></span><br><span class="line"><span class="comment">// updatedWords: éœ€è¦æ›´æ–°çš„å…³é”®è¯åˆ—è¡¨ï¼Œç”±äºä»æ•°æ®åº“ä¸­è·å–æ•°æ®å¸¸å¸¸æ˜¯æ•°ç»„çš„æ–¹å¼</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(words Keywords)</span> <span class="title">Clone</span><span class="params">(updatedWords []*Keyword)</span> <span class="title">Keywords</span></span> &#123;</span><br><span class="line">    newKeywords := Keywords&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k, v := <span class="keyword">range</span> words &#123;</span><br><span class="line">        <span class="comment">// è¿™é‡Œæ˜¯æµ…æ‹·è´ï¼Œç›´æ¥æ‹·è´äº†åœ°å€</span></span><br><span class="line">        newKeywords[k] = v</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// æ›¿æ¢æ‰éœ€è¦æ›´æ–°çš„å­—æ®µï¼Œè¿™é‡Œç”¨çš„æ˜¯æ·±æ‹·è´</span></span><br><span class="line">    <span class="keyword">for</span> _, word := <span class="keyword">range</span> updatedWords &#123;</span><br><span class="line">        newKeywords[word.word] = word.Clone()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> newKeywords</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="2ã€ç»“æ„å‹"><a href="#2ã€ç»“æ„å‹" class="headerlink" title="2ã€ç»“æ„å‹"></a>2ã€ç»“æ„å‹</h1><h2 id="ä»£ç†æ¨¡å¼-proxy"><a href="#ä»£ç†æ¨¡å¼-proxy" class="headerlink" title="ä»£ç†æ¨¡å¼ proxy"></a>ä»£ç†æ¨¡å¼ proxy</h2><p>ä¸ºå…¶ä»–å¯¹è±¡æä¾›â¼€ç§ä»£ç†ä»¥æ§åˆ¶è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚</p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231208710.png" alt="ä»£ç†æ¨¡å¼"></p>
<h3 id="é™æ€ä»£ç†"><a href="#é™æ€ä»£ç†" class="headerlink" title="é™æ€ä»£ç†"></a>é™æ€ä»£ç†</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> proxy</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;log&quot;</span></span><br><span class="line">    <span class="string">&quot;time&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// IUser IUser</span></span><br><span class="line"><span class="keyword">type</span> IUser <span class="keyword">interface</span> &#123;</span><br><span class="line">    Login(username, password <span class="keyword">string</span>) error</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// User ç”¨æˆ·</span></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Login ç”¨æˆ·ç™»å½•</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u *User)</span> <span class="title">Login</span><span class="params">(username, password <span class="keyword">string</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    <span class="comment">// ä¸å®ç°ç»†èŠ‚</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// UserProxy ä»£ç†ç±»</span></span><br><span class="line"><span class="keyword">type</span> UserProxy <span class="keyword">struct</span> &#123;</span><br><span class="line">    user *User</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewUserProxy NewUserProxy</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewUserProxy</span><span class="params">(user *User)</span> *<span class="title">UserProxy</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &amp;UserProxy&#123;</span><br><span class="line">        user: user,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Login ç™»å½•ï¼Œå’Œ user å®ç°ç›¸åŒçš„æ¥å£</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(p *UserProxy)</span> <span class="title">Login</span><span class="params">(username, password <span class="keyword">string</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    <span class="comment">// before è¿™é‡Œå¯èƒ½ä¼šæœ‰ä¸€äº›ç»Ÿè®¡çš„é€»è¾‘</span></span><br><span class="line">    start := time.Now()</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿™é‡Œæ˜¯åŸæœ‰çš„ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line">    <span class="keyword">if</span> err := p.user.Login(username, password); err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> err</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// after è¿™é‡Œå¯èƒ½ä¹Ÿæœ‰ä¸€äº›ç›‘æ§ç»Ÿè®¡çš„é€»è¾‘</span></span><br><span class="line">    log.Printf(<span class="string">&quot;user login cost time: %s&quot;</span>, time.Now().Sub(start))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ¡¥æ¥æ¨¡å¼-bridge"><a href="#æ¡¥æ¥æ¨¡å¼-bridge" class="headerlink" title="æ¡¥æ¥æ¨¡å¼ bridge"></a>æ¡¥æ¥æ¨¡å¼ bridge</h2><p>å°†ç±»çš„æŠ½è±¡éƒ¨åˆ†å’Œå®ƒçš„å®ç°éƒ¨åˆ†åˆ†ç¦»å¼€æ¥ï¼Œä½¿å®ƒä»¬å¯ä»¥ç‹¬ç«‹åœ°å˜åŒ–ã€‚</p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231210754.png" alt="æ¡¥æ¥æ¨¡å¼"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> bridge</span><br><span class="line"></span><br><span class="line"><span class="comment">// IMsgSender IMsgSender</span></span><br><span class="line"><span class="keyword">type</span> IMsgSender <span class="keyword">interface</span> &#123;</span><br><span class="line">    Send(msg <span class="keyword">string</span>) error</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// EmailMsgSender å‘é€é‚®ä»¶</span></span><br><span class="line"><span class="comment">// å¯èƒ½è¿˜æœ‰ ç”µè¯ã€çŸ­ä¿¡ç­‰å„ç§å®ç°</span></span><br><span class="line"><span class="keyword">type</span> EmailMsgSender <span class="keyword">struct</span> &#123;</span><br><span class="line">    emails []<span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewEmailMsgSender NewEmailMsgSender</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewEmailMsgSender</span><span class="params">(emails []<span class="keyword">string</span>)</span> *<span class="title">EmailMsgSender</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &amp;EmailMsgSender&#123;emails: emails&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Send Send</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *EmailMsgSender)</span> <span class="title">Send</span><span class="params">(msg <span class="keyword">string</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œå»å‘é€æ¶ˆæ¯</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// INotification é€šçŸ¥æ¥å£</span></span><br><span class="line"><span class="keyword">type</span> INotification <span class="keyword">interface</span> &#123;</span><br><span class="line">    Notify(msg <span class="keyword">string</span>) error</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ErrorNotification é”™è¯¯é€šçŸ¥</span></span><br><span class="line"><span class="comment">// åé¢å¯èƒ½è¿˜æœ‰ warning å„ç§çº§åˆ«</span></span><br><span class="line"><span class="keyword">type</span> ErrorNotification <span class="keyword">struct</span> &#123;</span><br><span class="line">    sender IMsgSender</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewErrorNotification NewErrorNotification</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewErrorNotification</span><span class="params">(sender IMsgSender)</span> *<span class="title">ErrorNotification</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &amp;ErrorNotification&#123;sender: sender&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Notify å‘é€é€šçŸ¥</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(n *ErrorNotification)</span> <span class="title">Notify</span><span class="params">(msg <span class="keyword">string</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> n.sender.Send(msg)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è£…é¥°æ¨¡å¼-decorator"><a href="#è£…é¥°æ¨¡å¼-decorator" class="headerlink" title="è£…é¥°æ¨¡å¼ decorator"></a>è£…é¥°æ¨¡å¼ decorator</h2><p>åŠ¨æ€åœ°ç»™â¼€ä¸ªå¯¹è±¡æ·»åŠ â¼€äº›é¢å¤–çš„èŒè´£ã€‚å®ƒæä¾›äº†ç”¨å­ç±»æ‰©å±•åŠŸèƒ½çš„â¼€ä¸ªçµæ´»çš„æ›¿ä»£ï¼Œæ¯”æ´¾ç”Ÿä¸€ä¸ªå­ç±»æ›´åŠ çµæ´»ã€‚</p>
<p><strong>é™„åŠ èŒè´£</strong></p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231212129.png" alt="è£…é¥°æ¨¡å¼"></p>
<p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ç”»ç”»çš„ä¾‹å­ï¼Œé»˜è®¤çš„ <code>Square</code> åªæœ‰åŸºç¡€çš„ç”»ç”»åŠŸèƒ½ï¼Œ <code>ColorSquare</code> ä¸ºä»–åŠ ä¸Šäº†é¢œè‰²</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> decorator</span><br><span class="line"></span><br><span class="line"><span class="comment">// IDraw IDraw</span></span><br><span class="line"><span class="keyword">type</span> IDraw <span class="keyword">interface</span> &#123;</span><br><span class="line">    Draw() <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Square æ­£æ–¹å½¢</span></span><br><span class="line"><span class="keyword">type</span> Square <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Draw Draw</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s Square)</span> <span class="title">Draw</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;this is a square&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ColorSquare æœ‰é¢œè‰²çš„æ­£æ–¹å½¢</span></span><br><span class="line"><span class="keyword">type</span> ColorSquare <span class="keyword">struct</span> &#123;</span><br><span class="line">    square IDraw</span><br><span class="line">    color  <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewColorSquare NewColorSquare</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewColorSquare</span><span class="params">(square IDraw, color <span class="keyword">string</span>)</span> <span class="title">ColorSquare</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> ColorSquare&#123;color: color, square: square&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Draw Draw</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c ColorSquare)</span> <span class="title">Draw</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> c.square.Draw() + <span class="string">&quot;, color is &quot;</span> + c.color</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é€‚é…å™¨æ¨¡å¼-adapter"><a href="#é€‚é…å™¨æ¨¡å¼-adapter" class="headerlink" title="é€‚é…å™¨æ¨¡å¼ adapter"></a>é€‚é…å™¨æ¨¡å¼ adapter</h2><p>å°†â¼€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆç”¨æˆ·å¸Œæœ›å¾—åˆ°çš„å¦â¼€ä¸ªæ¥å£ï¼Œå®ƒä½¿åŸæœ¬ä¸ç›¸å®¹çš„æ¥å£å¾—ä»¥ååŒâ¼¯ä½œã€‚</p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231214029.png" alt="é€‚é…å™¨æ¨¡å¼"></p>
<p>å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªè¿ç»´ç³»ç»Ÿï¼Œéœ€è¦åˆ†åˆ«è°ƒç”¨é˜¿é‡Œäº‘å’Œ AWS çš„ SDK åˆ›å»ºä¸»æœºï¼Œä¸¤ä¸ª SDK æä¾›çš„åˆ›å»ºä¸»æœºçš„æ¥å£ä¸ä¸€è‡´ï¼Œæ­¤æ—¶å°±å¯ä»¥é€šè¿‡é€‚é…å™¨æ¨¡å¼ï¼Œå°†ä¸¤ä¸ªæ¥å£ç»Ÿä¸€ã€‚</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> adapter</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ICreateServer åˆ›å»ºäº‘ä¸»æœº</span></span><br><span class="line"><span class="keyword">type</span> ICreateServer <span class="keyword">interface</span> &#123;</span><br><span class="line">    CreateServer(cpu, mem <span class="keyword">float64</span>) error</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AWSClient aws sdk</span></span><br><span class="line"><span class="keyword">type</span> AWSClient <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// RunInstance å¯åŠ¨å®ä¾‹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *AWSClient)</span> <span class="title">RunInstance</span><span class="params">(cpu, mem <span class="keyword">float64</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;aws client run success, cpuï¼š %f, mem: %f&quot;</span>, cpu, mem)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AwsClientAdapter é€‚é…å™¨</span></span><br><span class="line"><span class="keyword">type</span> AwsClientAdapter <span class="keyword">struct</span> &#123;</span><br><span class="line">    Client AWSClient</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CreateServer å¯åŠ¨å®ä¾‹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *AwsClientAdapter)</span> <span class="title">CreateServer</span><span class="params">(cpu, mem <span class="keyword">float64</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    a.Client.RunInstance(cpu, mem)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AliyunClient aliyun sdk</span></span><br><span class="line"><span class="keyword">type</span> AliyunClient <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CreateServer å¯åŠ¨å®ä¾‹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *AliyunClient)</span> <span class="title">CreateServer</span><span class="params">(cpu, mem <span class="keyword">int</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;aws client run success, cpuï¼š %d, mem: %d&quot;</span>, cpu, mem)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AliyunClientAdapter é€‚é…å™¨</span></span><br><span class="line"><span class="keyword">type</span> AliyunClientAdapter <span class="keyword">struct</span> &#123;</span><br><span class="line">    Client AliyunClient</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CreateServer å¯åŠ¨å®ä¾‹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a *AliyunClientAdapter)</span> <span class="title">CreateServer</span><span class="params">(cpu, mem <span class="keyword">float64</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    a.Client.CreateServer(<span class="keyword">int</span>(cpu), <span class="keyword">int</span>(mem))</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="é—¨é¢æ¨¡å¼-facade"><a href="#é—¨é¢æ¨¡å¼-facade" class="headerlink" title="é—¨é¢æ¨¡å¼ facade"></a>é—¨é¢æ¨¡å¼ facade</h2><p>å®šä¹‰â¼€ä¸ªé«˜å±‚æ¥å£ï¼Œä¸ºå­ç³»ç»Ÿä¸­çš„â¼€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„å¤–è§‚ï¼Œä»è€Œç®€åŒ–äº†è¯¥å­ç³»ç»Ÿçš„ä½¿ç”¨ã€‚</p>
<p><strong>å¯¹å¤–ç»Ÿä¸€æ¥å£</strong></p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231353536.jpeg" alt="é—¨é¢æ¨¡å¼"></p>
<blockquote>
<p>å‡è®¾ç°åœ¨æˆ‘æœ‰ä¸€ä¸ªç½‘ç«™ï¼Œä»¥å‰æœ‰ç™»å½•å’Œæ³¨å†Œçš„æµç¨‹ï¼Œç™»å½•çš„æ—¶å€™è°ƒç”¨ç”¨æˆ·çš„æŸ¥è¯¢æ¥å£ï¼Œæ³¨å†Œæ—¶è°ƒç”¨ç”¨æˆ·çš„åˆ›å»ºæ¥å£ã€‚ä¸ºäº†ç®€åŒ–ç”¨æˆ·çš„ä½¿ç”¨æµç¨‹ï¼Œæˆ‘ä»¬ç°åœ¨æä¾›ç›´æ¥éªŒè¯ç ç™»å½•/æ³¨å†Œçš„åŠŸèƒ½ï¼Œå¦‚æœè¯¥æ‰‹æœºå·å·²æ³¨å†Œé‚£ä¹ˆæˆ‘ä»¬å°±èµ°ç™»å½•æµç¨‹ï¼Œå¦‚æœè¯¥æ‰‹æœºå·æœªæ³¨å†Œï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±åˆ›å»ºä¸€ä¸ªæ–°çš„ç”¨æˆ·ã€‚</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> facade</span><br><span class="line"></span><br><span class="line"><span class="comment">// IUser ç”¨æˆ·æ¥å£</span></span><br><span class="line"><span class="keyword">type</span> IUser <span class="keyword">interface</span> &#123;</span><br><span class="line">    Login(phone <span class="keyword">int</span>, code <span class="keyword">int</span>) (*User, error)</span><br><span class="line">    Register(phone <span class="keyword">int</span>, code <span class="keyword">int</span>) (*User, error)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// IUserFacade é—¨é¢æ¨¡å¼</span></span><br><span class="line"><span class="keyword">type</span> IUserFacade <span class="keyword">interface</span> &#123;</span><br><span class="line">    LoginOrRegister(phone <span class="keyword">int</span>, code <span class="keyword">int</span>) error</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// User ç”¨æˆ·</span></span><br><span class="line"><span class="keyword">type</span> User <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// UserService UserService</span></span><br><span class="line"><span class="keyword">type</span> UserService <span class="keyword">struct</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Login ç™»å½•</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u UserService)</span> <span class="title">Login</span><span class="params">(phone <span class="keyword">int</span>, code <span class="keyword">int</span>)</span> <span class="params">(*User, error)</span></span> &#123;</span><br><span class="line">    <span class="comment">// æ ¡éªŒæ“ä½œ ...</span></span><br><span class="line">    <span class="keyword">return</span> &amp;User&#123;Name: <span class="string">&quot;test login&quot;</span>&#125;, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Register æ³¨å†Œ</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u UserService)</span> <span class="title">Register</span><span class="params">(phone <span class="keyword">int</span>, code <span class="keyword">int</span>)</span> <span class="params">(*User, error)</span></span> &#123;</span><br><span class="line">    <span class="comment">// æ ¡éªŒæ“ä½œ ...</span></span><br><span class="line">    <span class="comment">// åˆ›å»ºç”¨æˆ·</span></span><br><span class="line">    <span class="keyword">return</span> &amp;User&#123;Name: <span class="string">&quot;test register&quot;</span>&#125;, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// LoginOrRegister ç™»å½•æˆ–æ³¨å†Œ</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(u UserService)</span><span class="title">LoginOrRegister</span><span class="params">(phone <span class="keyword">int</span>, code <span class="keyword">int</span>)</span> <span class="params">(*User, error)</span></span> &#123;</span><br><span class="line">    user, err := u.Login(phone, code)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> user != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> user, <span class="literal">nil</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> u.Register(phone, code)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ç»„åˆæ¨¡å¼-composite"><a href="#ç»„åˆæ¨¡å¼-composite" class="headerlink" title="ç»„åˆæ¨¡å¼ composite"></a>ç»„åˆæ¨¡å¼ composite</h2><p>å°†å¯¹è±¡ç»„åˆæˆæ ‘å‹ç»“æ„ä»¥è¡¨ç¤ºâ€œæ•´ä½“-éƒ¨åˆ†â€çš„å±‚æ¬¡ç»“æ„ï¼Œä½¿å¾—ç”¨æˆ·å¯¹å•ä¸ªå¯¹è±¡å’Œç»„åˆå¯¹è±¡çš„ä½¿ç”¨å…·æœ‰â¼€è‡´æ€§ã€‚</p>
<p><strong>æ ‘å½¢ç›®å½•ç»“æ„</strong></p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231355688.png" alt="ç»„åˆæ¨¡å¼"></p>
<blockquote>
<p>å…¬å¸çš„äººå‘˜ç»„ç»‡å°±æ˜¯ä¸€ä¸ªå…¸å‹çš„æ ‘çŠ¶çš„ç»“æ„ï¼Œç°åœ¨å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰éƒ¨åˆ†ï¼Œå’Œå‘˜å·¥ï¼Œä¸¤ç§è§’è‰²ï¼Œä¸€ä¸ªéƒ¨é—¨ä¸‹é¢å¯ä»¥å­˜åœ¨å­éƒ¨é—¨å’Œå‘˜å·¥ï¼Œå‘˜å·¥ä¸‹é¢ä¸èƒ½å†åŒ…å«å…¶ä»–èŠ‚ç‚¹ã€‚</p>
</blockquote>
<p>æˆ‘ä»¬ç°åœ¨è¦å®ç°ä¸€ä¸ªç»Ÿè®¡ä¸€ä¸ªéƒ¨é—¨ä¸‹å‘˜å·¥æ•°é‡çš„åŠŸèƒ½</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> composite</span><br><span class="line"></span><br><span class="line"><span class="comment">// IOrganization ç»„ç»‡æ¥å£ï¼Œéƒ½å®ç°ç»Ÿè®¡äººæ•°çš„åŠŸèƒ½</span></span><br><span class="line"><span class="keyword">type</span> IOrganization <span class="keyword">interface</span> &#123;</span><br><span class="line">    Count() <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Employee å‘˜å·¥</span></span><br><span class="line"><span class="keyword">type</span> Employee <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Count äººæ•°ç»Ÿè®¡</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(Employee)</span> <span class="title">Count</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Department éƒ¨é—¨</span></span><br><span class="line"><span class="keyword">type</span> Department <span class="keyword">struct</span> &#123;</span><br><span class="line">    Name <span class="keyword">string</span></span><br><span class="line"></span><br><span class="line">    SubOrganizations []IOrganization</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Count äººæ•°ç»Ÿè®¡</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d Department)</span> <span class="title">Count</span><span class="params">()</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    c := <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> _, org := <span class="keyword">range</span> d.SubOrganizations &#123;</span><br><span class="line">        c += org.Count()</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AddSub æ·»åŠ å­èŠ‚ç‚¹</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *Department)</span> <span class="title">AddSub</span><span class="params">(org IOrganization)</span></span> &#123;</span><br><span class="line">    d.SubOrganizations = <span class="built_in">append</span>(d.SubOrganizations, org)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewOrganization æ„å»ºç»„ç»‡æ¶æ„ demo</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewOrganization</span><span class="params">()</span> <span class="title">IOrganization</span></span> &#123;</span><br><span class="line">    root := &amp;Department&#123;Name: <span class="string">&quot;root&quot;</span>&#125;</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ &#123;</span><br><span class="line">        root.AddSub(&amp;Employee&#123;&#125;)</span><br><span class="line">        root.AddSub(&amp;Department&#123;Name: <span class="string">&quot;sub&quot;</span>, SubOrganizations: []IOrganization&#123;&amp;Employee&#123;&#125;&#125;&#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> root</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="äº«å…ƒæ¨¡å¼-flyweight"><a href="#äº«å…ƒæ¨¡å¼-flyweight" class="headerlink" title="äº«å…ƒæ¨¡å¼ flyweight"></a>äº«å…ƒæ¨¡å¼ flyweight</h2><p>æä¾›æ”¯æŒå¤§é‡ç»†ç²’åº¦å¯¹è±¡å…±äº«çš„æœ‰æ•ˆæ–¹æ³•ã€‚</p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231358380.png" alt="äº«å…ƒæ¨¡å¼"></p>
<blockquote>
<p>è±¡æ£‹ï¼Œæ— è®ºæ˜¯ä»€ä¹ˆå¯¹å±€ï¼Œæ£‹å­çš„åŸºæœ¬å±æ€§å…¶å®æ˜¯å›ºå®šçš„ï¼Œå¹¶ä¸ä¼šå› ä¸ºéšç€ä¸‹æ£‹çš„è¿‡ç¨‹å˜åŒ–ã€‚é‚£æˆ‘ä»¬å°±å¯ä»¥æŠŠæ£‹å­å˜ä¸ºäº«å…ƒï¼Œè®©æ‰€æœ‰çš„å¯¹å±€éƒ½å…±äº«è¿™äº›å¯¹è±¡ï¼Œä»¥æ­¤è¾¾åˆ°èŠ‚çœå†…å­˜çš„ç›®çš„ã€‚</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> flyweight</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> units = <span class="keyword">map</span>[<span class="keyword">int</span>]*ChessPieceUnit&#123;</span><br><span class="line">    <span class="number">1</span>: &#123;</span><br><span class="line">        ID:    <span class="number">1</span>,</span><br><span class="line">        Name:  <span class="string">&quot;è»Š&quot;</span>,</span><br><span class="line">        Color: <span class="string">&quot;red&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="number">2</span>: &#123;</span><br><span class="line">        ID:    <span class="number">2</span>,</span><br><span class="line">        Name:  <span class="string">&quot;ç‚®&quot;</span>,</span><br><span class="line">        Color: <span class="string">&quot;red&quot;</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="comment">// ... å…¶ä»–æ£‹å­</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ChessPieceUnit æ£‹å­äº«å…ƒ</span></span><br><span class="line"><span class="keyword">type</span> ChessPieceUnit <span class="keyword">struct</span> &#123;</span><br><span class="line">    ID    <span class="keyword">uint</span></span><br><span class="line">    Name  <span class="keyword">string</span></span><br><span class="line">    Color <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewChessPieceUnit å·¥å‚</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewChessPieceUnit</span><span class="params">(id <span class="keyword">int</span>)</span> *<span class="title">ChessPieceUnit</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> units[id]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ChessPiece æ£‹å­</span></span><br><span class="line"><span class="keyword">type</span> ChessPiece <span class="keyword">struct</span> &#123;</span><br><span class="line">    Unit *ChessPieceUnit</span><br><span class="line">    X    <span class="keyword">int</span></span><br><span class="line">    Y    <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ChessBoard æ£‹å±€</span></span><br><span class="line"><span class="keyword">type</span> ChessBoard <span class="keyword">struct</span> &#123;</span><br><span class="line">    chessPieces <span class="keyword">map</span>[<span class="keyword">int</span>]*ChessPiece</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewChessBoard åˆå§‹åŒ–æ£‹ç›˜</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewChessBoard</span><span class="params">()</span> *<span class="title">ChessBoard</span></span> &#123;</span><br><span class="line">    board := &amp;ChessBoard&#123;chessPieces: <span class="keyword">map</span>[<span class="keyword">int</span>]*ChessPiece&#123;&#125;&#125;</span><br><span class="line">    <span class="keyword">for</span> id := <span class="keyword">range</span> units &#123;</span><br><span class="line">        board.chessPieces[id] = &amp;ChessPiece&#123;</span><br><span class="line">            Unit: NewChessPieceUnit(id),</span><br><span class="line">            X:    <span class="number">0</span>,</span><br><span class="line">            Y:    <span class="number">0</span>,</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> board</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Move ç§»åŠ¨æ£‹å­</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *ChessBoard)</span> <span class="title">Move</span><span class="params">(id, x, y <span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    c.chessPieces[id].X = x</span><br><span class="line">    c.chessPieces[id].Y = y</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="3ã€è¡Œä¸ºå‹"><a href="#3ã€è¡Œä¸ºå‹" class="headerlink" title="3ã€è¡Œä¸ºå‹"></a>3ã€è¡Œä¸ºå‹</h1><h2 id="è§‚å¯Ÿè€…æ¨¡å¼-observer"><a href="#è§‚å¯Ÿè€…æ¨¡å¼-observer" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼ observer"></a>è§‚å¯Ÿè€…æ¨¡å¼ observer</h2><p>å®šä¹‰å¯¹è±¡é—´çš„â¼€ç§â¼€å¯¹å¤šçš„ä¾èµ–å…³ç³»ï¼Œå½“â¼€ä¸ªå¯¹è±¡çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜æ—¶ï¼Œæ‰€æœ‰ä¾èµ–äºå®ƒçš„å¯¹è±¡éƒ½å¾—åˆ°é€šçŸ¥å¹¶è‡ªåŠ¨æ›´æ–°ã€‚</p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231408656.png" alt="è§‚å¯Ÿè€…æ¨¡å¼"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> observer</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ISubject subject</span></span><br><span class="line"><span class="keyword">type</span> ISubject <span class="keyword">interface</span> &#123;</span><br><span class="line">    Register(observer IObserver)</span><br><span class="line">    Remove(observer IObserver)</span><br><span class="line">    Notify(msg <span class="keyword">string</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// IObserver è§‚å¯Ÿè€…</span></span><br><span class="line"><span class="keyword">type</span> IObserver <span class="keyword">interface</span> &#123;</span><br><span class="line">    Update(msg <span class="keyword">string</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Subject Subject</span></span><br><span class="line"><span class="keyword">type</span> Subject <span class="keyword">struct</span> &#123;</span><br><span class="line">    observers []IObserver</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Register æ³¨å†Œ</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(sub *Subject)</span> <span class="title">Register</span><span class="params">(observer IObserver)</span></span> &#123;</span><br><span class="line">    sub.observers = <span class="built_in">append</span>(sub.observers, observer)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Remove ç§»é™¤è§‚å¯Ÿè€…</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(sub *Subject)</span> <span class="title">Remove</span><span class="params">(observer IObserver)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> i, ob := <span class="keyword">range</span> sub.observers &#123;</span><br><span class="line">        <span class="keyword">if</span> ob == observer &#123;</span><br><span class="line">            sub.observers = <span class="built_in">append</span>(sub.observers[:i], sub.observers[i+<span class="number">1</span>:]...)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Notify é€šçŸ¥</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(sub *Subject)</span> <span class="title">Notify</span><span class="params">(msg <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> _, o := <span class="keyword">range</span> sub.observers &#123;</span><br><span class="line">        o.Update(msg)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Observer1 Observer1</span></span><br><span class="line"><span class="keyword">type</span> Observer1 <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Update å®ç°è§‚å¯Ÿè€…æ¥å£</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(Observer1)</span> <span class="title">Update</span><span class="params">(msg <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;Observer1: %s&quot;</span>, msg)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Observer2 Observer2</span></span><br><span class="line"><span class="keyword">type</span> Observer2 <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Update å®ç°è§‚å¯Ÿè€…æ¥å£</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(Observer2)</span> <span class="title">Update</span><span class="params">(msg <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">    fmt.Printf(<span class="string">&quot;Observer2: %s&quot;</span>, msg)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æ¨¡æ¿æ¨¡å¼-template"><a href="#æ¨¡æ¿æ¨¡å¼-template" class="headerlink" title="æ¨¡æ¿æ¨¡å¼ template"></a>æ¨¡æ¿æ¨¡å¼ template</h2><p>å®šä¹‰â¼€ä¸ªæ“ä½œä¸­çš„ç®—æ³•éª¨æ¶ï¼Œè€Œå°†â¼€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜â¼€ä¸ªç®—æ³•çš„ç»“æ„å³å¯é‡æ–°å®šä¹‰ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤ã€‚<br><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231409069.png" alt="æ¨¡æ¿æ¨¡å¼"></p>
<blockquote>
<p>è¦åšä¸€ä¸ªçŸ­ä¿¡æ¨é€çš„ç³»ç»Ÿï¼Œé‚£ä¹ˆéœ€è¦</p>
<ol>
<li>æ£€æŸ¥çŸ­ä¿¡å­—æ•°æ˜¯å¦è¶…è¿‡é™åˆ¶</li>
<li>æ£€æŸ¥æ‰‹æœºå·æ˜¯å¦æ­£ç¡®</li>
<li>å‘é€çŸ­ä¿¡</li>
<li>è¿”å›çŠ¶æ€</li>
</ol>
<p>æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œåœ¨å‘é€çŸ­ä¿¡çš„æ—¶å€™ç”±äºä¸åŒçš„ä¾›åº”å•†è°ƒç”¨çš„æ¥å£ä¸åŒï¼Œæ‰€ä»¥ä¼šæœ‰ä¸€äº›å®ç°ä¸Šçš„å·®å¼‚ï¼Œä½†æ˜¯ä»–çš„ç®—æ³•ï¼ˆä¸šåŠ¡é€»è¾‘ï¼‰æ˜¯å›ºå®šçš„</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> template</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ISMS ISMS</span></span><br><span class="line"><span class="keyword">type</span> ISMS <span class="keyword">interface</span> &#123;</span><br><span class="line">    send(content <span class="keyword">string</span>, phone <span class="keyword">int</span>) error</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SMS çŸ­ä¿¡å‘é€åŸºç±»</span></span><br><span class="line"><span class="keyword">type</span> sms <span class="keyword">struct</span> &#123;</span><br><span class="line">    ISMS</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Valid æ ¡éªŒçŸ­ä¿¡å­—æ•°</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *sms)</span> <span class="title">Valid</span><span class="params">(content <span class="keyword">string</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(content) &gt; <span class="number">63</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;content is too long&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Send å‘é€çŸ­ä¿¡</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *sms)</span> <span class="title">Send</span><span class="params">(content <span class="keyword">string</span>, phone <span class="keyword">int</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> err := s.Valid(content); err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> err</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨å­ç±»çš„æ–¹æ³•å‘é€çŸ­ä¿¡</span></span><br><span class="line">    <span class="keyword">return</span> s.send(content, phone)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// TelecomSms èµ°ç”µä¿¡é€šé“</span></span><br><span class="line"><span class="keyword">type</span> TelecomSms <span class="keyword">struct</span> &#123;</span><br><span class="line">    *sms</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewTelecomSms NewTelecomSms</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewTelecomSms</span><span class="params">()</span> *<span class="title">TelecomSms</span></span> &#123;</span><br><span class="line">    tel := &amp;TelecomSms&#123;&#125;</span><br><span class="line">    <span class="comment">// è¿™é‡Œæœ‰ç‚¹ç»•ï¼Œæ˜¯å› ä¸º go æ²¡æœ‰ç»§æ‰¿ï¼Œç”¨åµŒå¥—ç»“æ„ä½“çš„æ–¹æ³•è¿›è¡Œæ¨¡æ‹Ÿ</span></span><br><span class="line">    <span class="comment">// è¿™é‡Œå°†å­ç±»ä½œä¸ºæ¥å£åµŒå…¥çˆ¶ç±»ï¼Œå°±å¯ä»¥è®©çˆ¶ç±»çš„æ¨¡æ¿æ–¹æ³• Send è°ƒç”¨åˆ°å­ç±»çš„å‡½æ•°</span></span><br><span class="line">    <span class="comment">// å®é™…ä½¿ç”¨ä¸­ï¼Œæˆ‘ä»¬å¹¶ä¸ä¼šè¿™ä¹ˆå†™ï¼Œéƒ½æ˜¯é‡‡ç”¨ç»„åˆ+æ¥å£çš„æ–¹å¼å®Œæˆç±»ä¼¼çš„åŠŸèƒ½</span></span><br><span class="line">    tel.sms = &amp;sms&#123;ISMS: tel&#125;</span><br><span class="line">    <span class="keyword">return</span> tel</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(tel *TelecomSms)</span> <span class="title">send</span><span class="params">(content <span class="keyword">string</span>, phone <span class="keyword">int</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;send by telecom success&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ç­–ç•¥æ¨¡å¼-strategy"><a href="#ç­–ç•¥æ¨¡å¼-strategy" class="headerlink" title="ç­–ç•¥æ¨¡å¼ strategy"></a>ç­–ç•¥æ¨¡å¼ strategy</h2><p>å®šä¹‰â¼€ç³»åˆ—ç®—æ³•ï¼ŒæŠŠå®ƒä»¬â¼€ä¸ªä¸ªå°è£…èµ·æ¥ï¼Œå¹¶ä¸”ä½¿å®ƒä»¬ä¹‹é—´å¯äº’ç›¸æ›¿æ¢ï¼Œä»è€Œè®©ç®—æ³•å¯ä»¥ç‹¬ç«‹äºä½¿ç”¨å®ƒçš„ç”¨æˆ·è€Œå˜åŒ–ã€‚</p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231410116.png" alt="ç­–ç•¥æ¨¡å¼"></p>
<blockquote>
<p>åœ¨ä¿å­˜æ–‡ä»¶çš„æ—¶å€™ï¼Œç”±äºæ”¿ç­–æˆ–è€…å…¶ä»–çš„åŸå› å¯èƒ½éœ€è¦é€‰æ‹©ä¸åŒçš„å­˜å‚¨æ–¹å¼ï¼Œæ•æ„Ÿæ•°æ®æˆ‘ä»¬éœ€è¦åŠ å¯†å­˜å‚¨ï¼Œä¸æ•æ„Ÿçš„æ•°æ®æˆ‘ä»¬å¯ä»¥ç›´æ¥æ˜æ–‡ä¿å­˜ã€‚</p>
</blockquote>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> strategy</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;io/ioutil&quot;</span></span><br><span class="line">    <span class="string">&quot;os&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// StorageStrategy å­˜å‚¨ç­–ç•¥</span></span><br><span class="line"><span class="keyword">type</span> StorageStrategy <span class="keyword">interface</span> &#123;</span><br><span class="line">    Save(name <span class="keyword">string</span>, data []<span class="keyword">byte</span>) error</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> strategys = <span class="keyword">map</span>[<span class="keyword">string</span>]StorageStrategy&#123;</span><br><span class="line">    <span class="string">&quot;file&quot;</span>:         &amp;fileStorage&#123;&#125;,</span><br><span class="line">    <span class="string">&quot;encrypt_file&quot;</span>: &amp;encryptFileStorage&#123;&#125;,</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewStorageStrategy NewStorageStrategy</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewStorageStrategy</span><span class="params">(t <span class="keyword">string</span>)</span> <span class="params">(StorageStrategy, error)</span></span> &#123;</span><br><span class="line">    s, ok := strategys[t]</span><br><span class="line">    <span class="keyword">if</span> !ok &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;not found StorageStrategy: %s&quot;</span>, t)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> s, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// FileStorage ä¿å­˜åˆ°æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">type</span> fileStorage <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Save Save</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *fileStorage)</span> <span class="title">Save</span><span class="params">(name <span class="keyword">string</span>, data []<span class="keyword">byte</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> ioutil.WriteFile(name, data, os.ModeAppend)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// encryptFileStorage åŠ å¯†ä¿å­˜åˆ°æ–‡ä»¶</span></span><br><span class="line"><span class="keyword">type</span> encryptFileStorage <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Save Save</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *encryptFileStorage)</span> <span class="title">Save</span><span class="params">(name <span class="keyword">string</span>, data []<span class="keyword">byte</span>)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    <span class="comment">// åŠ å¯†</span></span><br><span class="line">    data, err := encrypt(data)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> err</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ioutil.WriteFile(name, data, os.ModeAppend)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">encrypt</span><span class="params">(data []<span class="keyword">byte</span>)</span> <span class="params">([]<span class="keyword">byte</span>, error)</span></span> &#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œå®ç°åŠ å¯†ç®—æ³•</span></span><br><span class="line">    <span class="keyword">return</span> data, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="èŒè´£é“¾æ¨¡å¼-chain-of-responsibility"><a href="#èŒè´£é“¾æ¨¡å¼-chain-of-responsibility" class="headerlink" title="èŒè´£é“¾æ¨¡å¼ chain of responsibility"></a>èŒè´£é“¾æ¨¡å¼ chain of responsibility</h2><p>é€šè¿‡ç»™å¤šä¸ªå¯¹è±¡å¤„ç†è¯·æ±‚çš„æœºä¼šï¼Œå‡å°‘è¯·æ±‚çš„å‘é€è€…ä¸æ¥æ”¶è€…ä¹‹é—´çš„è€¦åˆã€‚å°†æ¥æ”¶å¯¹è±¡é“¾æ¥èµ·æ¥ï¼Œåœ¨é“¾ä¸­ä¼ é€’è¯· æ±‚ï¼Œç›´åˆ°æœ‰â¼€ä¸ªå¯¹è±¡å¤„ç†è¿™ä¸ªè¯·æ±‚ã€‚<br><strong>ä¼ é€’èŒè´£</strong></p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231411476.png" alt="èŒè´£é“¾æ¨¡å¼"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Package chain èŒè´£é“¾æ¨¡å¼</span></span><br><span class="line"><span class="comment">// ğŸŒ° å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸ªæ ¡å›­è®ºå›ï¼Œç”±äºç¤¾åŒºè§„ç« åˆ¶åº¦ã€å¹¿å‘Šã€æ³•å¾‹æ³•è§„çš„åŸå› éœ€è¦å¯¹ç”¨æˆ·çš„å‘è¨€è¿›è¡Œæ•æ„Ÿè¯è¿‡æ»¤</span></span><br><span class="line"><span class="comment">//    å¦‚æœè¢«åˆ¤å®šä¸ºæ•æ„Ÿè¯ï¼Œé‚£ä¹ˆè¿™ç¯‡å¸–å­å°†ä¼šè¢«å°ç¦</span></span><br><span class="line"><span class="keyword">package</span> chain</span><br><span class="line"></span><br><span class="line"><span class="comment">// SensitiveWordFilter æ•æ„Ÿè¯è¿‡æ»¤å™¨ï¼Œåˆ¤å®šæ˜¯å¦æ˜¯æ•æ„Ÿè¯</span></span><br><span class="line"><span class="keyword">type</span> SensitiveWordFilter <span class="keyword">interface</span> &#123;</span><br><span class="line">    Filter(content <span class="keyword">string</span>) <span class="keyword">bool</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SensitiveWordFilterChain èŒè´£é“¾</span></span><br><span class="line"><span class="keyword">type</span> SensitiveWordFilterChain <span class="keyword">struct</span> &#123;</span><br><span class="line">    filters []SensitiveWordFilter</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AddFilter æ·»åŠ ä¸€ä¸ªè¿‡æ»¤å™¨</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *SensitiveWordFilterChain)</span> <span class="title">AddFilter</span><span class="params">(filter SensitiveWordFilter)</span></span> &#123;</span><br><span class="line">    c.filters = <span class="built_in">append</span>(c.filters, filter)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Filter æ‰§è¡Œè¿‡æ»¤</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *SensitiveWordFilterChain)</span> <span class="title">Filter</span><span class="params">(content <span class="keyword">string</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> _, filter := <span class="keyword">range</span> c.filters &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœå‘ç°æ•æ„Ÿç›´æ¥è¿”å›ç»“æœ</span></span><br><span class="line">        <span class="keyword">if</span> filter.Filter(content) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AdSensitiveWordFilter å¹¿å‘Š</span></span><br><span class="line"><span class="keyword">type</span> AdSensitiveWordFilter <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Filter å®ç°è¿‡æ»¤ç®—æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *AdSensitiveWordFilter)</span> <span class="title">Filter</span><span class="params">(content <span class="keyword">string</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> å®ç°ç®—æ³•</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// PoliticalWordFilter æ”¿æ²»æ•æ„Ÿ</span></span><br><span class="line"><span class="keyword">type</span> PoliticalWordFilter <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Filter å®ç°è¿‡æ»¤ç®—æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *PoliticalWordFilter)</span> <span class="title">Filter</span><span class="params">(content <span class="keyword">string</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    <span class="comment">// <span class="doctag">TODO:</span> å®ç°ç®—æ³•</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="çŠ¶æ€æ¨¡å¼-state"><a href="#çŠ¶æ€æ¨¡å¼-state" class="headerlink" title="çŠ¶æ€æ¨¡å¼ state"></a>çŠ¶æ€æ¨¡å¼ state</h2><p>å…è®¸â¼€ä¸ªå¯¹è±¡åœ¨å…¶å†…éƒ¨çŠ¶æ€æ”¹å˜æ—¶æ”¹å˜å®ƒçš„è¡Œä¸ºã€‚</p>
<p><strong>çŠ¶æ€å˜æˆç±»</strong></p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231412401.png" alt="çŠ¶æ€æ¨¡å¼"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Package state çŠ¶æ€æ¨¡å¼</span></span><br><span class="line"><span class="comment">// ç¬”è®°è¯·æŸ¥çœ‹: https://lailin.xyz/state.html</span></span><br><span class="line"><span class="comment">// è¿™æ˜¯ä¸€ä¸ªå·¥ä½œæµçš„ä¾‹å­ï¼Œåœ¨ä¼ä¸šå†…éƒ¨æˆ–è€…æ˜¯å­¦æ ¡æˆ‘ä»¬ç»å¸¸ä¼šçœ‹åˆ°å¾ˆå¤šå®¡æ‰¹æµç¨‹</span></span><br><span class="line"><span class="comment">// å‡è®¾æˆ‘ä»¬æœ‰ä¸€ä¸ªæŠ¥é”€çš„æµç¨‹: å‘˜å·¥æäº¤æŠ¥é”€ç”³è¯· -&gt; ç›´å±éƒ¨é—¨é¢†å¯¼å®¡æ‰¹ -&gt; è´¢åŠ¡å®¡æ‰¹ -&gt; ç»“æŸ</span></span><br><span class="line"><span class="comment">// åœ¨è¿™ä¸ªå®¡æ‰¹æµä¸­ï¼Œå¤„åœ¨ä¸åŒçš„ç¯èŠ‚å°±æ˜¯ä¸åŒçš„çŠ¶æ€</span></span><br><span class="line"><span class="comment">// è€Œæµç¨‹çš„å®¡æ‰¹ã€é©³å›å°±æ˜¯ä¸åŒçš„äº‹ä»¶</span></span><br><span class="line"><span class="keyword">package</span> state</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Machine çŠ¶æ€æœº</span></span><br><span class="line"><span class="keyword">type</span> Machine <span class="keyword">struct</span> &#123;</span><br><span class="line">    state IState</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SetState æ›´æ–°çŠ¶æ€</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Machine)</span> <span class="title">SetState</span><span class="params">(state IState)</span></span> &#123;</span><br><span class="line">    m.state = state</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GetStateName è·å–å½“å‰çŠ¶æ€</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Machine)</span> <span class="title">GetStateName</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> m.state.GetName()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Machine)</span> <span class="title">Approval</span><span class="params">()</span></span> &#123;</span><br><span class="line">    m.state.Approval(m)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(m *Machine)</span> <span class="title">Reject</span><span class="params">()</span></span> &#123;</span><br><span class="line">    m.state.Reject(m)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// IState çŠ¶æ€</span></span><br><span class="line"><span class="keyword">type</span> IState <span class="keyword">interface</span> &#123;</span><br><span class="line">    <span class="comment">// å®¡æ‰¹é€šè¿‡</span></span><br><span class="line">    Approval(m *Machine)</span><br><span class="line">    <span class="comment">// é©³å›</span></span><br><span class="line">    Reject(m *Machine)</span><br><span class="line">    <span class="comment">// è·å–å½“å‰çŠ¶æ€åç§°</span></span><br><span class="line">    GetName() <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// leaderApproveState ç›´å±é¢†å¯¼å®¡æ‰¹</span></span><br><span class="line"><span class="keyword">type</span> leaderApproveState <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Approval è·å–çŠ¶æ€åå­—</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(leaderApproveState)</span> <span class="title">Approval</span><span class="params">(m *Machine)</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;leader å®¡æ‰¹æˆåŠŸ&quot;</span>)</span><br><span class="line">    m.SetState(GetFinanceApproveState())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GetName è·å–çŠ¶æ€åå­—</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(leaderApproveState)</span> <span class="title">GetName</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;LeaderApproveState&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Reject è·å–çŠ¶æ€åå­—</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(leaderApproveState)</span> <span class="title">Reject</span><span class="params">(m *Machine)</span></span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetLeaderApproveState</span><span class="params">()</span> <span class="title">IState</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &amp;leaderApproveState&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// financeApproveState è´¢åŠ¡å®¡æ‰¹</span></span><br><span class="line"><span class="keyword">type</span> financeApproveState <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Approval å®¡æ‰¹é€šè¿‡</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f financeApproveState)</span> <span class="title">Approval</span><span class="params">(m *Machine)</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;è´¢åŠ¡å®¡æ‰¹æˆåŠŸ&quot;</span>)</span><br><span class="line">    fmt.Println(<span class="string">&quot;å‡ºå‘æ‰“æ¬¾æ“ä½œ&quot;</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ‹’ç»</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f financeApproveState)</span> <span class="title">Reject</span><span class="params">(m *Machine)</span></span> &#123;</span><br><span class="line">    m.SetState(GetLeaderApproveState())</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GetName è·å–åå­—</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f financeApproveState)</span> <span class="title">GetName</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;FinanceApproveState&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GetFinanceApproveState GetFinanceApproveState</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">GetFinanceApproveState</span><span class="params">()</span> <span class="title">IState</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &amp;financeApproveState&#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è¿­ä»£å™¨æ¨¡å¼-iterator"><a href="#è¿­ä»£å™¨æ¨¡å¼-iterator" class="headerlink" title="è¿­ä»£å™¨æ¨¡å¼ iterator"></a>è¿­ä»£å™¨æ¨¡å¼ iterator</h2><p>æä¾›â¼€ç§â½…æ³•æ¥é¡ºåºè®¿é—®â¼€ä¸ªèšåˆå¯¹è±¡ä¸­çš„å„ä¸ªå…ƒç´ è€Œä¸éœ€è¦æš´éœ²è¯¥å¯¹è±¡çš„å†…éƒ¨è¡¨ç¤ºã€‚</p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231412859.png" alt="è¿­ä»£å™¨æ¨¡å¼"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> iterator</span><br><span class="line"></span><br><span class="line"><span class="comment">// Iterator è¿­ä»£å™¨æ¥å£</span></span><br><span class="line"><span class="keyword">type</span> Iterator <span class="keyword">interface</span> &#123;</span><br><span class="line">    HasNext() <span class="keyword">bool</span></span><br><span class="line">    Next()</span><br><span class="line">    <span class="comment">// è·å–å½“å‰å…ƒç´ ï¼Œç”±äº Go 1.15 ä¸­è¿˜æ²¡æœ‰æ³›å‹ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥è¿”å› interface&#123;&#125;</span></span><br><span class="line">    CurrentItem() <span class="keyword">interface</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ArrayInt æ•°ç»„</span></span><br><span class="line"><span class="keyword">type</span> ArrayInt []<span class="keyword">int</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Iterator è¿”å›è¿­ä»£å™¨</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(a ArrayInt)</span> <span class="title">Iterator</span><span class="params">()</span> <span class="title">Iterator</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &amp;ArrayIntIterator&#123;</span><br><span class="line">        arrayInt: a,</span><br><span class="line">        index:    <span class="number">0</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ArrayIntIterator æ•°ç»„è¿­ä»£</span></span><br><span class="line"><span class="keyword">type</span> ArrayIntIterator <span class="keyword">struct</span> &#123;</span><br><span class="line">    arrayInt ArrayInt</span><br><span class="line">    index    <span class="keyword">int</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// HasNext æ˜¯å¦æœ‰ä¸‹ä¸€ä¸ª</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(iter *ArrayIntIterator)</span> <span class="title">HasNext</span><span class="params">()</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> iter.index &lt; <span class="built_in">len</span>(iter.arrayInt)<span class="number">-1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Next æ¸¸æ ‡åŠ ä¸€</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(iter *ArrayIntIterator)</span> <span class="title">Next</span><span class="params">()</span></span> &#123;</span><br><span class="line">    iter.index++</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// CurrentItem è·å–å½“å‰å…ƒç´ </span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(iter *ArrayIntIterator)</span> <span class="title">CurrentItem</span><span class="params">()</span> <span class="title">interface</span></span>&#123;&#125; &#123;</span><br><span class="line">    <span class="keyword">return</span> iter.arrayInt[iter.index]</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="è®¿é—®è€…æ¨¡å¼-visitor"><a href="#è®¿é—®è€…æ¨¡å¼-visitor" class="headerlink" title="è®¿é—®è€…æ¨¡å¼ visitor"></a>è®¿é—®è€…æ¨¡å¼ visitor</h2><p>è¡¨ç¤ºâ¼€ä¸ªä½œç”¨äºæŸå¯¹è±¡ç»“æ„ä¸­çš„å„å…ƒç´ çš„æ“ä½œï¼Œä½¿å¾—åœ¨ä¸æ”¹å˜å„å…ƒç´ çš„ç±»çš„å‰æä¸‹å®šä¹‰ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°æ“ä½œã€‚</p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231413188.png" alt="è®¿é—®è€…æ¨¡å¼"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> visitor</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;path&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Visitor è®¿é—®è€…</span></span><br><span class="line"><span class="keyword">type</span> Visitor <span class="keyword">interface</span> &#123;</span><br><span class="line">    Visit(IResourceFile) error</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// IResourceFile IResourceFile</span></span><br><span class="line"><span class="keyword">type</span> IResourceFile <span class="keyword">interface</span> &#123;</span><br><span class="line">    Accept(Visitor) error</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewResourceFile NewResourceFile</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewResourceFile</span><span class="params">(filepath <span class="keyword">string</span>)</span> <span class="params">(IResourceFile, error)</span></span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> path.Ext(filepath) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;.ppt&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> &amp;PPTFile&#123;path: filepath&#125;, <span class="literal">nil</span></span><br><span class="line">    <span class="keyword">case</span> <span class="string">&quot;.pdf&quot;</span>:</span><br><span class="line">        <span class="keyword">return</span> &amp;PdfFile&#123;path: filepath&#125;, <span class="literal">nil</span></span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;not found file type: %s&quot;</span>, filepath)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// PdfFile PdfFile</span></span><br><span class="line"><span class="keyword">type</span> PdfFile <span class="keyword">struct</span> &#123;</span><br><span class="line">    path <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Accept Accept</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *PdfFile)</span> <span class="title">Accept</span><span class="params">(visitor Visitor)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> visitor.Visit(f)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// PPTFile PPTFile</span></span><br><span class="line"><span class="keyword">type</span> PPTFile <span class="keyword">struct</span> &#123;</span><br><span class="line">    path <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Accept Accept</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(f *PPTFile)</span> <span class="title">Accept</span><span class="params">(visitor Visitor)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> visitor.Visit(f)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Compressor å®ç°å‹ç¼©åŠŸèƒ½</span></span><br><span class="line"><span class="keyword">type</span> Compressor <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Visit å®ç°è®¿é—®è€…æ¨¡å¼æ–¹æ³•</span></span><br><span class="line"><span class="comment">// æˆ‘ä»¬å¯ä»¥å‘ç°ç”±äºæ²¡æœ‰å‡½æ•°é‡è½½ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡æ–­è¨€æ¥æ ¹æ®ä¸åŒçš„ç±»å‹è°ƒç”¨ä¸åŒå‡½æ•°</span></span><br><span class="line"><span class="comment">// ä½†æ˜¯æˆ‘ä»¬å³ä½¿ä¸é‡‡ç”¨è®¿é—®è€…æ¨¡å¼ï¼Œæˆ‘ä»¬å…¶å®ä¹Ÿæ˜¯å¯ä»¥è¿™ä¹ˆæ“ä½œçš„</span></span><br><span class="line"><span class="comment">// å¹¶ä¸”ç”±äºé‡‡ç”¨äº†ç±»å‹æ–­è¨€ï¼Œæ‰€ä»¥å¦‚æœéœ€è¦æ“ä½œçš„å¯¹è±¡æ¯”è¾ƒå¤šçš„è¯ï¼Œè¿™ä¸ªå‡½æ•°å…¶å®ä¹Ÿä¼šè†¨èƒ€çš„æ¯”è¾ƒå‰å®³</span></span><br><span class="line"><span class="comment">// åç»­å¯ä»¥è€ƒè™‘æŒ‰ç…§å‘½åçº¦å®šä½¿ç”¨ generate è‡ªåŠ¨ç”Ÿæˆä»£ç </span></span><br><span class="line"><span class="comment">// æˆ–è€…æ˜¯ä½¿ç”¨åå°„ç®€åŒ–</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Compressor)</span> <span class="title">Visit</span><span class="params">(r IResourceFile)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> f := r.(<span class="keyword">type</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> *PPTFile:</span><br><span class="line">        <span class="keyword">return</span> c.VisitPPTFile(f)</span><br><span class="line">    <span class="keyword">case</span> *PdfFile:</span><br><span class="line">        <span class="keyword">return</span> c.VisitPDFFile(f)</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">return</span> fmt.Errorf(<span class="string">&quot;not found resource typr: %#v&quot;</span>, r)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// VisitPPTFile VisitPPTFile</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Compressor)</span> <span class="title">VisitPPTFile</span><span class="params">(f *PPTFile)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;this is ppt file&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// VisitPDFFile VisitPDFFile</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *Compressor)</span> <span class="title">VisitPDFFile</span><span class="params">(f *PdfFile)</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;this is pdf file&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å¤‡å¿˜å½•æ¨¡å¼-memento"><a href="#å¤‡å¿˜å½•æ¨¡å¼-memento" class="headerlink" title="å¤‡å¿˜å½•æ¨¡å¼ memento"></a>å¤‡å¿˜å½•æ¨¡å¼ memento</h2><p>åœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·â¼€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ï¼Œä»è€Œå¯ç”¨åœ¨ä»¥åå°†è¯¥å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€ã€‚</p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231414592.png" alt="å¤‡å¿˜å½•æ¨¡å¼"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Package memento å¤‡å¿˜å½•æ¨¡å¼</span></span><br><span class="line"><span class="comment">// ä¸‹é¢è¿™ä¸ªä¾‹å­é‡‡ç”¨åŸè¯¾ç¨‹çš„ä¾‹å­ï¼Œä¸€ä¸ªè¾“å…¥ç¨‹åº</span></span><br><span class="line"><span class="comment">// å¦‚æœè¾“å…¥ :list åˆ™æ˜¾ç¤ºå½“å‰ä¿å­˜çš„å†…å®¹</span></span><br><span class="line"><span class="comment">// å¦‚æœè¾“å…¥ :undo åˆ™åˆ é™¤ä¸Šä¸€æ¬¡çš„è¾“å…¥</span></span><br><span class="line"><span class="comment">// å¦‚æœè¾“å…¥å…¶ä»–çš„å†…å®¹åˆ™è¿½åŠ ä¿å­˜</span></span><br><span class="line"><span class="keyword">package</span> memento</span><br><span class="line"></span><br><span class="line"><span class="comment">// InputText ç”¨äºä¿å­˜æ•°æ®</span></span><br><span class="line"><span class="keyword">type</span> InputText <span class="keyword">struct</span> &#123;</span><br><span class="line">    content <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Append è¿½åŠ æ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(in *InputText)</span> <span class="title">Append</span><span class="params">(content <span class="keyword">string</span>)</span></span> &#123;</span><br><span class="line">    in.content += content</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GetText è·å–æ•°æ®</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(in *InputText)</span> <span class="title">GetText</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> in.content</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Snapshot åˆ›å»ºå¿«ç…§</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(in *InputText)</span> <span class="title">Snapshot</span><span class="params">()</span> *<span class="title">Snapshot</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &amp;Snapshot&#123;content: in.content&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Restore ä»å¿«ç…§ä¸­æ¢å¤</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(in *InputText)</span> <span class="title">Restore</span><span class="params">(s *Snapshot)</span></span> &#123;</span><br><span class="line">    in.content = s.GetText()</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Snapshot å¿«ç…§ï¼Œç”¨äºå­˜å‚¨æ•°æ®å¿«ç…§</span></span><br><span class="line"><span class="comment">// å¯¹äºå¿«ç…§æ¥è¯´ï¼Œåªèƒ½ä¸èƒ½è¢«å¤–éƒ¨ï¼ˆä¸åŒåŒ…ï¼‰ä¿®æ”¹ï¼Œåªèƒ½è·å–æ•°æ®ï¼Œæ»¡è¶³å°è£…çš„ç‰¹æ€§</span></span><br><span class="line"><span class="keyword">type</span> Snapshot <span class="keyword">struct</span> &#123;</span><br><span class="line">    content <span class="keyword">string</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GetText GetText</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s *Snapshot)</span> <span class="title">GetText</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> s.content</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å‘½ä»¤æ¨¡å¼-command"><a href="#å‘½ä»¤æ¨¡å¼-command" class="headerlink" title="å‘½ä»¤æ¨¡å¼ command"></a>å‘½ä»¤æ¨¡å¼ command</h2><p>å°†â¼€ä¸ªè¯·æ±‚å°è£…ä¸ºâ¼€ä¸ªå¯¹è±¡ï¼Œä»è€Œå¯ç”¨ä¸åŒçš„è¯·æ±‚å¯¹å®¢æˆ·è¿›è¡Œå‚æ•°åŒ–ï¼Œå°†è¯·æ±‚æ’é˜Ÿæˆ–è®°å½•è¯·æ±‚â½‡å¿—ï¼Œæ”¯æŒå¯æ’¤é”€çš„æ“ä½œã€‚</p>
<p><strong>æ—¥å¿—è®°å½•ï¼Œå¯æ’¤é”€</strong></p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231415154.png" alt="å‘½ä»¤æ¨¡å¼"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Package command å‘½ä»¤æ¨¡å¼</span></span><br><span class="line"><span class="comment">// Blog: https://lailin.xyz/post/command.html</span></span><br><span class="line"><span class="comment">// è¿™æ˜¯ç¤ºä¾‹ä¸€ï¼Œé‡‡ç”¨å°†å‡½æ•°å°è£…ä¸ºå¯¹è±¡çš„æ–¹å¼å®ç°ï¼Œ</span></span><br><span class="line"><span class="comment">// ç¤ºä¾‹è¯´æ˜:</span></span><br><span class="line"><span class="comment">// å‡è®¾ç°åœ¨æœ‰ä¸€ä¸ªæ¸¸æˆæœåŠ¡ï¼Œæˆ‘ä»¬æ­£åœ¨å®ç°ä¸€ä¸ªæ¸¸æˆåç«¯</span></span><br><span class="line"><span class="comment">// ä½¿ç”¨ä¸€ä¸ª goroutine ä¸æ–­æ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯è¯·æ±‚çš„å‘½ä»¤ï¼Œå¹¶ä¸”å°†å®ƒæ”¾ç½®åˆ°ä¸€ä¸ªé˜Ÿåˆ—å½“ä¸­</span></span><br><span class="line"><span class="comment">// ç„¶åæˆ‘ä»¬åœ¨å¦å¤–ä¸€ä¸ª goroutine ä¸­æ¥æ‰§è¡Œå®ƒ</span></span><br><span class="line"><span class="keyword">package</span> command</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;fmt&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// ICommand å‘½ä»¤</span></span><br><span class="line"><span class="keyword">type</span> ICommand <span class="keyword">interface</span> &#123;</span><br><span class="line">    Execute() error</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// StartCommand æ¸¸æˆå¼€å§‹è¿è¡Œ</span></span><br><span class="line"><span class="keyword">type</span> StartCommand <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewStartCommand NewStartCommand</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewStartCommand</span><span class="params">( /*æ­£å¸¸æƒ…å†µä¸‹è¿™é‡Œä¼šæœ‰ä¸€äº›å‚æ•°*/ )</span> *<span class="title">StartCommand</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &amp;StartCommand&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Execute Execute</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *StartCommand)</span> <span class="title">Execute</span><span class="params">()</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;game start&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ArchiveCommand æ¸¸æˆå­˜æ¡£</span></span><br><span class="line"><span class="keyword">type</span> ArchiveCommand <span class="keyword">struct</span>&#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewArchiveCommand NewArchiveCommand</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewArchiveCommand</span><span class="params">( /*æ­£å¸¸æƒ…å†µä¸‹è¿™é‡Œä¼šæœ‰ä¸€äº›å‚æ•°*/ )</span> *<span class="title">ArchiveCommand</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> &amp;ArchiveCommand&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Execute Execute</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(c *ArchiveCommand)</span> <span class="title">Execute</span><span class="params">()</span> <span class="title">error</span></span> &#123;</span><br><span class="line">    fmt.Println(<span class="string">&quot;game archive&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="è§£é‡Šå™¨æ¨¡å¼-interpreter"><a href="#è§£é‡Šå™¨æ¨¡å¼-interpreter" class="headerlink" title="è§£é‡Šå™¨æ¨¡å¼ interpreter"></a>è§£é‡Šå™¨æ¨¡å¼ interpreter</h2><p>ç»™å®šâ¼€ç§è¯­è¨€ï¼Œå®šä¹‰å®ƒçš„æ–‡æ³•è¡¨ç¤ºï¼Œå¹¶å®šä¹‰â¼€ä¸ªè§£é‡Šå™¨ï¼Œè¯¥è§£é‡Šå™¨ç”¨æ¥æ ¹æ®æ–‡æ³•è¡¨ç¤ºæ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­ã€‚<br><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231416104.png" alt="è§£é‡Šå™¨æ¨¡å¼"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Package interpreter è§£é‡Šå™¨æ¨¡å¼</span></span><br><span class="line"><span class="comment">// é‡‡ç”¨åŸè¯¾ç¨‹çš„ç¤ºä¾‹, å¹¶ä¸”åšäº†ä¸€ä¸‹ç®€åŒ–</span></span><br><span class="line"><span class="comment">// å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªç›‘æ§ç³»ç»Ÿ</span></span><br><span class="line"><span class="comment">// ç°åœ¨éœ€è¦å®ç°ä¸€ä¸ªå‘Šè­¦æ¨¡å—ï¼Œå¯ä»¥æ ¹æ®è¾“å…¥çš„å‘Šè­¦è§„åˆ™æ¥å†³å®šæ˜¯å¦è§¦å‘å‘Šè­¦</span></span><br><span class="line"><span class="comment">// å‘Šè­¦è§„åˆ™æ”¯æŒ &amp;&amp;ã€&gt;ã€&lt; 3ç§è¿ç®—ç¬¦</span></span><br><span class="line"><span class="comment">// å…¶ä¸­ &gt;ã€&lt; ä¼˜å…ˆçº§æ¯”  &amp;&amp; æ›´é«˜</span></span><br><span class="line"><span class="keyword">package</span> interpreter</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;regexp&quot;</span></span><br><span class="line">    <span class="string">&quot;strconv&quot;</span></span><br><span class="line">    <span class="string">&quot;strings&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// AlertRule å‘Šè­¦è§„åˆ™</span></span><br><span class="line"><span class="keyword">type</span> AlertRule <span class="keyword">struct</span> &#123;</span><br><span class="line">    expression IExpression</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewAlertRule NewAlertRule</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewAlertRule</span><span class="params">(rule <span class="keyword">string</span>)</span> <span class="params">(*AlertRule, error)</span></span> &#123;</span><br><span class="line">    exp, err := NewAndExpression(rule)</span><br><span class="line">    <span class="keyword">return</span> &amp;AlertRule&#123;expression: exp&#125;, err</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Interpret åˆ¤æ–­å‘Šè­¦æ˜¯å¦è§¦å‘</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(r AlertRule)</span> <span class="title">Interpret</span><span class="params">(stats <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">float64</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> r.expression.Interpret(stats)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// IExpression è¡¨è¾¾å¼æ¥å£</span></span><br><span class="line"><span class="keyword">type</span> IExpression <span class="keyword">interface</span> &#123;</span><br><span class="line">    Interpret(stats <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">float64</span>) <span class="keyword">bool</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// GreaterExpression &gt;</span></span><br><span class="line"><span class="keyword">type</span> GreaterExpression <span class="keyword">struct</span> &#123;</span><br><span class="line">    key   <span class="keyword">string</span></span><br><span class="line">    value <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Interpret Interpret</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g GreaterExpression)</span> <span class="title">Interpret</span><span class="params">(stats <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">float64</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    v, ok := stats[g.key]</span><br><span class="line">    <span class="keyword">if</span> !ok &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> v &gt; g.value</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewGreaterExpression NewGreaterExpression</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewGreaterExpression</span><span class="params">(exp <span class="keyword">string</span>)</span> <span class="params">(*GreaterExpression, error)</span></span> &#123;</span><br><span class="line">    data := regexp.MustCompile(<span class="string">`\s+`</span>).Split(strings.TrimSpace(exp), <span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(data) != <span class="number">3</span> || data[<span class="number">1</span>] != <span class="string">&quot;&gt;&quot;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;exp is invalid: %s&quot;</span>, exp)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    val, err := strconv.ParseFloat(data[<span class="number">2</span>], <span class="number">10</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;exp is invalid: %s&quot;</span>, exp)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &amp;GreaterExpression&#123;</span><br><span class="line">        key:   data[<span class="number">0</span>],</span><br><span class="line">        value: val,</span><br><span class="line">    &#125;, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// LessExpression &lt;</span></span><br><span class="line"><span class="keyword">type</span> LessExpression <span class="keyword">struct</span> &#123;</span><br><span class="line">    key   <span class="keyword">string</span></span><br><span class="line">    value <span class="keyword">float64</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Interpret Interpret</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(g LessExpression)</span> <span class="title">Interpret</span><span class="params">(stats <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">float64</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    v, ok := stats[g.key]</span><br><span class="line">    <span class="keyword">if</span> !ok &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> v &lt; g.value</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewLessExpression NewLessExpression</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewLessExpression</span><span class="params">(exp <span class="keyword">string</span>)</span> <span class="params">(*LessExpression, error)</span></span> &#123;</span><br><span class="line">    data := regexp.MustCompile(<span class="string">`\s+`</span>).Split(strings.TrimSpace(exp), <span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(data) != <span class="number">3</span> || data[<span class="number">1</span>] != <span class="string">&quot;&lt;&quot;</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;exp is invalid: %s&quot;</span>, exp)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    val, err := strconv.ParseFloat(data[<span class="number">2</span>], <span class="number">10</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">nil</span>, fmt.Errorf(<span class="string">&quot;exp is invalid: %s&quot;</span>, exp)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &amp;LessExpression&#123;</span><br><span class="line">        key:   data[<span class="number">0</span>],</span><br><span class="line">        value: val,</span><br><span class="line">    &#125;, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// AndExpression &amp;&amp;</span></span><br><span class="line"><span class="keyword">type</span> AndExpression <span class="keyword">struct</span> &#123;</span><br><span class="line">    expressions []IExpression</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Interpret Interpret</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(e AndExpression)</span> <span class="title">Interpret</span><span class="params">(stats <span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">float64</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    <span class="keyword">for</span> _, expression := <span class="keyword">range</span> e.expressions &#123;</span><br><span class="line">        <span class="keyword">if</span> !expression.Interpret(stats) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// NewAndExpression NewAndExpression</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">NewAndExpression</span><span class="params">(exp <span class="keyword">string</span>)</span> <span class="params">(*AndExpression, error)</span></span> &#123;</span><br><span class="line">    exps := strings.Split(exp, <span class="string">&quot;&amp;&amp;&quot;</span>)</span><br><span class="line">    expressions := <span class="built_in">make</span>([]IExpression, <span class="built_in">len</span>(exps))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i, e := <span class="keyword">range</span> exps &#123;</span><br><span class="line">        <span class="keyword">var</span> expression IExpression</span><br><span class="line">        <span class="keyword">var</span> err error</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> strings.Contains(e, <span class="string">&quot;&gt;&quot;</span>):</span><br><span class="line">            expression, err = NewGreaterExpression(e)</span><br><span class="line">        <span class="keyword">case</span> strings.Contains(e, <span class="string">&quot;&lt;&quot;</span>):</span><br><span class="line">            expression, err = NewLessExpression(e)</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            err = fmt.Errorf(<span class="string">&quot;exp is invalid: %s&quot;</span>, exp)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span>, err</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        expressions[i] = expression</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &amp;AndExpression&#123;expressions: expressions&#125;, <span class="literal">nil</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸­ä»‹æ¨¡å¼-mediator"><a href="#ä¸­ä»‹æ¨¡å¼-mediator" class="headerlink" title="ä¸­ä»‹æ¨¡å¼ mediator"></a>ä¸­ä»‹æ¨¡å¼ mediator</h2><p>ç”¨â¼€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…â¼€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ã€‚å®ƒä½¿å„å¯¹è±¡ä¸éœ€è¦æ˜¾å¼åœ°ç›¸äº’è°ƒç”¨ï¼Œä»è€Œè¾¾åˆ°ä½è€¦åˆï¼Œè¿˜å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å¯¹è±¡é—´çš„äº¤äº’ã€‚</p>
<p><strong>ä¸ç›´æ¥å¼•ç”¨</strong></p>
<p><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/img/202202231416106.png" alt="ä¸­ä»‹æ¨¡å¼"></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Package mediator ä¸­ä»‹æ¨¡å¼</span></span><br><span class="line"><span class="comment">// é‡‡ç”¨åŸè¯¾ç¨‹çš„ç¤ºä¾‹ï¼Œå¹¶ä¸”åšäº†ä¸€äº›è£å‰ª</span></span><br><span class="line"><span class="comment">// å‡è®¾æˆ‘ä»¬ç°åœ¨æœ‰ä¸€ä¸ªè¾ƒä¸ºå¤æ‚çš„å¯¹è¯æ¡†ï¼Œé‡Œé¢åŒ…æ‹¬ï¼Œç™»å½•ç»„ä»¶ï¼Œæ³¨å†Œç»„ä»¶ï¼Œä»¥åŠé€‰æ‹©æ¡†</span></span><br><span class="line"><span class="comment">// å½“é€‰æ‹©æ¡†é€‰æ‹©â€œç™»å½•â€æ—¶ï¼Œå±•ç¤ºç™»å½•ç›¸å…³ç»„ä»¶</span></span><br><span class="line"><span class="comment">// å½“é€‰æ‹©æ¡†é€‰æ‹©â€œæ³¨å†Œâ€æ—¶ï¼Œå±•ç¤ºæ³¨å†Œç›¸å…³ç»„ä»¶</span></span><br><span class="line"><span class="keyword">package</span> mediator</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> (</span><br><span class="line">    <span class="string">&quot;fmt&quot;</span></span><br><span class="line">    <span class="string">&quot;reflect&quot;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment">// Input å‡è®¾è¿™è¡¨ç¤ºä¸€ä¸ªè¾“å…¥æ¡†</span></span><br><span class="line"><span class="keyword">type</span> Input <span class="keyword">string</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// String String</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(i Input)</span> <span class="title">String</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">string</span>(i)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Selection å‡è®¾è¿™è¡¨ç¤ºä¸€ä¸ªé€‰æ‹©æ¡†</span></span><br><span class="line"><span class="keyword">type</span> Selection <span class="keyword">string</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Selected å½“å‰é€‰ä¸­çš„å¯¹è±¡</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(s Selection)</span> <span class="title">Selected</span><span class="params">()</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">string</span>(s)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Button å‡è®¾è¿™è¡¨ç¤ºä¸€ä¸ªæŒ‰é’®</span></span><br><span class="line"><span class="keyword">type</span> Button <span class="keyword">struct</span> &#123;</span><br><span class="line">    onClick <span class="function"><span class="keyword">func</span><span class="params">()</span></span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// SetOnClick æ·»åŠ ç‚¹å‡»äº‹ä»¶å›è°ƒ</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(b *Button)</span> <span class="title">SetOnClick</span><span class="params">(f <span class="keyword">func</span>()</span>)</span> &#123;</span><br><span class="line">    b.onClick = f</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// IMediator ä¸­ä»‹æ¨¡å¼æ¥å£</span></span><br><span class="line"><span class="keyword">type</span> IMediator <span class="keyword">interface</span> &#123;</span><br><span class="line">    HandleEvent(component <span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Dialog å¯¹è¯æ¡†ç»„ä»¶</span></span><br><span class="line"><span class="keyword">type</span> Dialog <span class="keyword">struct</span> &#123;</span><br><span class="line">    LoginButton         *Button</span><br><span class="line">    RegButton           *Button</span><br><span class="line">    Selection           *Selection</span><br><span class="line">    UsernameInput       *Input</span><br><span class="line">    PasswordInput       *Input</span><br><span class="line">    RepeatPasswordInput *Input</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// HandleEvent HandleEvent</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="params">(d *Dialog)</span> <span class="title">HandleEvent</span><span class="params">(component <span class="keyword">interface</span>&#123;&#125;)</span></span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> reflect.DeepEqual(component, d.Selection):</span><br><span class="line">        <span class="keyword">if</span> d.Selection.Selected() == <span class="string">&quot;ç™»å½•&quot;</span> &#123;</span><br><span class="line">            fmt.Println(<span class="string">&quot;select login&quot;</span>)</span><br><span class="line">            fmt.Printf(<span class="string">&quot;show: %s\n&quot;</span>, d.UsernameInput)</span><br><span class="line">            fmt.Printf(<span class="string">&quot;show: %s\n&quot;</span>, d.PasswordInput)</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> d.Selection.Selected() == <span class="string">&quot;æ³¨å†Œ&quot;</span> &#123;</span><br><span class="line">            fmt.Println(<span class="string">&quot;select register&quot;</span>)</span><br><span class="line">            fmt.Printf(<span class="string">&quot;show: %s\n&quot;</span>, d.UsernameInput)</span><br><span class="line">            fmt.Printf(<span class="string">&quot;show: %s\n&quot;</span>, d.PasswordInput)</span><br><span class="line">            fmt.Printf(<span class="string">&quot;show: %s\n&quot;</span>, d.RepeatPasswordInput)</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// others, å¦‚æœç‚¹å‡»äº†ç™»å½•æŒ‰é’®ï¼Œæ³¨å†ŒæŒ‰é’®</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div><div class="article-licensing box"><div class="licensing-title"><p>Goçš„è®¾è®¡æ¨¡å¼</p><p><a href="http://blog.sukiu.top/Design-Pattern/Go-Design-Pattern/">http://blog.sukiu.top/Design-Pattern/Go-Design-Pattern/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>ä½œè€…</h6><p>SukiEva</p></div></div><div class="level-item is-narrow"><div><h6>å‘å¸ƒäº</h6><p>2022-02-23</p></div></div><div class="level-item is-narrow"><div><h6>æ›´æ–°äº</h6><p>2022-02-23</p></div></div><div class="level-item is-narrow"><div><h6>è®¸å¯åè®®</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="" rel="noopener" target="_blank" title="CC BY-NC-SA 4.0" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Go/">Go</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/Knowledge/Brain-Teaser/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">æ™ºåŠ›é¢˜</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/Algorithm/Simulation/"><span class="level-item">æ¨¡æ‹Ÿé¢˜</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">è¯„è®º</h3><div id="comment-container"></div><link rel="stylesheet" href="https://unpkg.com/gitalk@1.7.2/dist/gitalk.css"><script src="https://unpkg.com/gitalk@1.7.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "a2806e61def939fdcbd2e987bfc177b6",
            repo: "SukiEva.github.io",
            owner: "SukiEva",
            clientID: "8542444b11c2adac4574",
            clientSecret: "3bfc002a0a942d7dfb1eeada021f62c499ec2af9",
            admin: ["SukiEva"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 10,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            language: "zh-CN",
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">ç›®å½•</h3><ul class="menu-list"><li><a class="level is-mobile" href="#1ã€åˆ›å»ºå‹"><span class="level-left"><span class="level-item">1</span><span class="level-item">1ã€åˆ›å»ºå‹</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#å•ä¾‹æ¨¡å¼-singleton"><span class="level-left"><span class="level-item">1.1</span><span class="level-item">å•ä¾‹æ¨¡å¼ singleton</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#é¥¿æ±‰å¼"><span class="level-left"><span class="level-item">1.1.1</span><span class="level-item">é¥¿æ±‰å¼</span></span></a></li><li><a class="level is-mobile" href="#æ‡’æ±‰å¼ï¼ˆåŒé‡æ£€æµ‹ï¼‰"><span class="level-left"><span class="level-item">1.1.2</span><span class="level-item">æ‡’æ±‰å¼ï¼ˆåŒé‡æ£€æµ‹ï¼‰</span></span></a></li></ul></li><li><a class="level is-mobile" href="#å·¥å‚æ¨¡å¼-factory"><span class="level-left"><span class="level-item">1.2</span><span class="level-item">å·¥å‚æ¨¡å¼ factory</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#ç®€å•å·¥å‚"><span class="level-left"><span class="level-item">1.2.1</span><span class="level-item">ç®€å•å·¥å‚</span></span></a></li><li><a class="level is-mobile" href="#å·¥å‚æ–¹æ³•"><span class="level-left"><span class="level-item">1.2.2</span><span class="level-item">å·¥å‚æ–¹æ³•</span></span></a></li></ul></li><li><a class="level is-mobile" href="#å»ºé€ è€…æ¨¡å¼-builder"><span class="level-left"><span class="level-item">1.3</span><span class="level-item">å»ºé€ è€…æ¨¡å¼ builder</span></span></a></li><li><a class="level is-mobile" href="#åŸå‹æ¨¡å¼-prototype"><span class="level-left"><span class="level-item">1.4</span><span class="level-item">åŸå‹æ¨¡å¼ prototype</span></span></a></li></ul></li><li><a class="level is-mobile" href="#2ã€ç»“æ„å‹"><span class="level-left"><span class="level-item">2</span><span class="level-item">2ã€ç»“æ„å‹</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#ä»£ç†æ¨¡å¼-proxy"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">ä»£ç†æ¨¡å¼ proxy</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#é™æ€ä»£ç†"><span class="level-left"><span class="level-item">2.1.1</span><span class="level-item">é™æ€ä»£ç†</span></span></a></li></ul></li><li><a class="level is-mobile" href="#æ¡¥æ¥æ¨¡å¼-bridge"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">æ¡¥æ¥æ¨¡å¼ bridge</span></span></a></li><li><a class="level is-mobile" href="#è£…é¥°æ¨¡å¼-decorator"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">è£…é¥°æ¨¡å¼ decorator</span></span></a></li><li><a class="level is-mobile" href="#é€‚é…å™¨æ¨¡å¼-adapter"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">é€‚é…å™¨æ¨¡å¼ adapter</span></span></a></li><li><a class="level is-mobile" href="#é—¨é¢æ¨¡å¼-facade"><span class="level-left"><span class="level-item">2.5</span><span class="level-item">é—¨é¢æ¨¡å¼ facade</span></span></a></li><li><a class="level is-mobile" href="#ç»„åˆæ¨¡å¼-composite"><span class="level-left"><span class="level-item">2.6</span><span class="level-item">ç»„åˆæ¨¡å¼ composite</span></span></a></li><li><a class="level is-mobile" href="#äº«å…ƒæ¨¡å¼-flyweight"><span class="level-left"><span class="level-item">2.7</span><span class="level-item">äº«å…ƒæ¨¡å¼ flyweight</span></span></a></li></ul></li><li><a class="level is-mobile" href="#3ã€è¡Œä¸ºå‹"><span class="level-left"><span class="level-item">3</span><span class="level-item">3ã€è¡Œä¸ºå‹</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#è§‚å¯Ÿè€…æ¨¡å¼-observer"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">è§‚å¯Ÿè€…æ¨¡å¼ observer</span></span></a></li><li><a class="level is-mobile" href="#æ¨¡æ¿æ¨¡å¼-template"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">æ¨¡æ¿æ¨¡å¼ template</span></span></a></li><li><a class="level is-mobile" href="#ç­–ç•¥æ¨¡å¼-strategy"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">ç­–ç•¥æ¨¡å¼ strategy</span></span></a></li><li><a class="level is-mobile" href="#èŒè´£é“¾æ¨¡å¼-chain-of-responsibility"><span class="level-left"><span class="level-item">3.4</span><span class="level-item">èŒè´£é“¾æ¨¡å¼ chain of responsibility</span></span></a></li><li><a class="level is-mobile" href="#çŠ¶æ€æ¨¡å¼-state"><span class="level-left"><span class="level-item">3.5</span><span class="level-item">çŠ¶æ€æ¨¡å¼ state</span></span></a></li><li><a class="level is-mobile" href="#è¿­ä»£å™¨æ¨¡å¼-iterator"><span class="level-left"><span class="level-item">3.6</span><span class="level-item">è¿­ä»£å™¨æ¨¡å¼ iterator</span></span></a></li><li><a class="level is-mobile" href="#è®¿é—®è€…æ¨¡å¼-visitor"><span class="level-left"><span class="level-item">3.7</span><span class="level-item">è®¿é—®è€…æ¨¡å¼ visitor</span></span></a></li><li><a class="level is-mobile" href="#å¤‡å¿˜å½•æ¨¡å¼-memento"><span class="level-left"><span class="level-item">3.8</span><span class="level-item">å¤‡å¿˜å½•æ¨¡å¼ memento</span></span></a></li><li><a class="level is-mobile" href="#å‘½ä»¤æ¨¡å¼-command"><span class="level-left"><span class="level-item">3.9</span><span class="level-item">å‘½ä»¤æ¨¡å¼ command</span></span></a></li><li><a class="level is-mobile" href="#è§£é‡Šå™¨æ¨¡å¼-interpreter"><span class="level-left"><span class="level-item">3.10</span><span class="level-item">è§£é‡Šå™¨æ¨¡å¼ interpreter</span></span></a></li><li><a class="level is-mobile" href="#ä¸­ä»‹æ¨¡å¼-mediator"><span class="level-left"><span class="level-item">3.11</span><span class="level-item">ä¸­ä»‹æ¨¡å¼ mediator</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/blog/avatar.jpg" alt="SukiEva"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">SukiEva</p><p class="is-size-6 is-block">Developer</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>China</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ–‡ç« </p><a href="/archives"><p class="title">53</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">åˆ†ç±»</p><a href="/categories"><p class="title">12</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">æ ‡ç­¾</p><a href="/tags"><p class="title">31</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/SukiEva" target="_blank" rel="noopener">å…³æ³¨æˆ‘</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Navigation" href="https://sukiu.top"><i class="fas fa-compass"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/SukiEva"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Email" href="Mailto:dev.suki@outlook.com"><i class="fa fa-envelope"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Rss" href="/rss.xml"><i class="fas fa-rss"></i></a></div><div><hr><center><p id="hitokoto">å–æ¬¡èŠ±ä¸›æ‡’å›é¡¾ï¼ŒåŠç¼˜ä¿®é“åŠç¼˜å›ã€‚</p></center></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="https://picgo-1303870432.cos.ap-shanghai.myqcloud.com/blog/favicon.ico" alt="åƒåç”°" height="28"></a><p class="is-size-7"><span>&copy; 2022 SukiEva</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a><br><span id="busuanzi_container_site_uv">å…±<span id="busuanzi_value_site_uv">0</span>ä¸ªè®¿å®¢</span></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="GitHub" href="https://github.com/"><i class="fab fa-github"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://unpkg.com/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://unpkg.com/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://unpkg.com/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://unpkg.com/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "æ­¤ç½‘ç«™ä½¿ç”¨Cookieæ¥æ”¹å–„æ‚¨çš„ä½“éªŒã€‚",
          dismiss: "çŸ¥é“äº†ï¼",
          allow: "å…è®¸ä½¿ç”¨Cookie",
          deny: "æ‹’ç»",
          link: "äº†è§£æ›´å¤š",
          policy: "Cookieæ”¿ç­–",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://unpkg.com/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://unpkg.com/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><link rel="stylesheet" href="https://unpkg.com/katex@0.15.1/dist/katex.min.css"><script src="https://unpkg.com/katex@0.15.1/dist/katex.min.js" defer></script><script src="https://unpkg.com/katex@0.15.1/dist/contrib/auto-render.min.js" defer></script><script src="https://unpkg.com/katex@0.15.1/dist/contrib/mhchem.min.js" defer></script><script>window.addEventListener("load", function() {
            document.querySelectorAll('[role="article"] > .content').forEach(function(element) {
                renderMathInElement(element);
            });
        });</script><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://unpkg.com/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><div id="outdated"><h6>Your browser is out-of-date!</h6><p>Update your browser to view this website correctly.&amp;npsb;<a id="btnUpdateBrowser" target="_blank" rel="noopener" href="http://outdatedbrowser.com/">Update my browser now </a></p><p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">Ã—</a></p></div><script src="https://unpkg.com/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script><script>window.addEventListener("load", function () {
            outdatedBrowser({
                bgColor: '#f25648',
                color: '#ffffff',
                lowerThan: 'object-fit' // display on IE11 or below
            });
        });</script><!--!--><script src="/js/main.js" defer></script><script src="/js/custom.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ...","untitled":"(æ— æ ‡é¢˜)","posts":"æ–‡ç« ","pages":"é¡µé¢","categories":"åˆ†ç±»","tags":"æ ‡ç­¾"});
        });</script></body></html>